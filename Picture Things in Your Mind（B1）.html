<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´å­¸ç¿’ç¶²é ç”Ÿæˆå™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&amp;family=Inter:wght@400;500;600;700&amp;family=Material+Symbols+Outlined" rel="stylesheet">
    <style>
        * { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
        
        body {
            background: linear-gradient(135deg, #f8fafb 0%, #f0f4f8 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .vocab-word { 
            border-bottom: 2px solid #60a5fa; 
            cursor: pointer; 
            color: #2563eb; 
            font-weight: 600; 
            transition: all 0.2s ease; 
            padding: 2px 4px;
            border-radius: 2px;
        }
        .vocab-word:hover { 
            background-color: #dbeafe;
            border-bottom-color: #2563eb;
        }
        .vocab-word-custom { 
            border-bottom: 2px solid #f87171; 
            cursor: pointer; 
            color: #dc2626; 
            font-weight: 600; 
            transition: all 0.2s ease; 
            padding: 2px 4px;
            border-radius: 2px;
        }
        .vocab-word-custom:hover { 
            background-color: #fee2e2;
            border-bottom-color: #991b1b;
        }
        #floating-card { 
            transition: opacity 0.2s, transform 0.2s ease; 
            pointer-events: none; 
            z-index: 9999;
            animation: slideUp 0.3s ease;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .modal { transition: all 0.3s ease-in-out; }
        .modal.hidden { opacity: 0; pointer-events: none; }
        #quiz-modal { transition: all 0.3s ease-in-out; }
        #quiz-modal.hidden { opacity: 0; pointer-events: none; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .selected-word { 
            background-color: #fef3c7; 
            border-bottom: 2px solid #eab308; 
            font-weight: 600;
            padding: 2px 4px;
            border-radius: 2px;
        }
        #selection-popup { 
            transition: all 0.2s ease; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .learning-card {
            transition: all 0.3s ease;
        }
        .learning-card:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.08);
        }
        
        /* Sticky video styles */
        #video-container.sticky-video {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 480px;
            height: 270px;
            padding-top: 0 !important;
            max-width: 90vw;
            z-index: 1000;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.3), 0 8px 10px -6px rgb(0 0 0 / 0.3);
            border: 2px solid #fff;
        }
        
        #video-container.sticky-video #player {
            pointer-events: auto;
        }

        #floating-close-btn {
            position: fixed;
            top: 45px;
            right: 20px;
            z-index: 1001;
        }

        @media (max-width: 768px) {
            #video-container.sticky-video {
                width: 320px;
                height: 180px;
                right: 10px;
                top: 70px;
            }
            
            #floating-close-btn {
                top: 35px;
                right: 10px;
            }
        }
        
        /* æ¼¢å ¡é¸å–®æ¨£å¼ */
        #mobile-menu {
            transition: all 0.3s ease;
        }
        #mobile-menu.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .hamburger-line {
            transition: all 0.3s ease;
        }
        #hamburger-btn.active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        #hamburger-btn.active .hamburger-line:nth-child(2) {
            opacity: 0;
        }
        #hamburger-btn.active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        /* Ensure Read and Pause buttons are visible in summary mode */
        body.summary-mode .flex.gap-1.items-center {
            display: flex !important;
}
        
        /* Hide specific segment controls in summary mode */
        body.summary-mode .segment-time-btn,
        body.summary-mode .segment-time-inputs,
        body.summary-mode .segment-edit-btn,
        body.summary-mode .segment-insert-btn {
            display: none !important;
        }
            
        /* Hide time input fields */
        .flex.items-center.gap-0.bg-blue-50 {
            display: none !important;
        }
</style>
<!-- Code injected by Five-server -->
  
  <script src="https://www.youtube.com/iframe_api"></script><style id="_goober"> @keyframes go2264125279{from{transform:scale(0) rotate(45deg);opacity:0;}to{transform:scale(1) rotate(45deg);opacity:1;}}@keyframes go3020080000{from{transform:scale(0);opacity:0;}to{transform:scale(1);opacity:1;}}@keyframes go463499852{from{transform:scale(0) rotate(90deg);opacity:0;}to{transform:scale(1) rotate(90deg);opacity:1;}}@keyframes go1268368563{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}@keyframes go1310225428{from{transform:scale(0) rotate(45deg);opacity:0;}to{transform:scale(1) rotate(45deg);opacity:1;}}@keyframes go651618207{0%{height:0;width:0;opacity:0;}40%{height:0;width:6px;opacity:1;}100%{opacity:1;height:10px;}}@keyframes go901347462{from{transform:scale(0.6);opacity:0.4;}to{transform:scale(1);opacity:1;}}.go4109123758{z-index:9999;}.go4109123758 > *{pointer-events:auto;}</style><style>.rr--group{display:flex;width:100%;position:relative}.rr--box{display:flex;width:100%;flex-grow:1;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rr--svg{display:flex;aspect-ratio:1;width:100%;flex-grow:1;overflow:clip;pointer-events:none}@supports not (overflow: clip){.rr--svg{overflow:auto}}.rr--box:focus,.rr--box:focus-visible,.rr-reset:focus-visible,.rr-reset:focus{outline:none;box-shadow:none}.rr--focus-reset{outline:6px double #0079ff}.rr--box:focus-visible .rr--svg{outline:6px double #0079ff;isolation:isolate}.rr--reset{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0;right:0;bottom:50%}[dir=rtl] .rr--reset{left:0;right:auto}.rr--dir-y .rr--reset{bottom:0;right:50%}.rr--disabled{opacity:.5;cursor:not-allowed}.rr--disabled .rr--svg{pointer-events:none}.rr--pointer .rr--box{cursor:pointer}.rr--dir-x{flex-direction:row}.rr--dir-y{flex-direction:column}.rr--space-sm .rr--svg{padding:8%}.rr--space-md .rr--svg{padding:12.5%}.rr--space-lg .rr--svg{padding:17.5%}.rr--dir-x.rr--gap-sm .rr--svg{margin:0 6.25%}.rr--dir-x.rr--gap-sm .rr--box:focus-visible:after{width:87.5%;left:6.25%}.rr--dir-x.rr--gap-md .rr--svg{margin:0 12.5%}.rr--dir-x.rr--gap-md .rr--box:focus-visible:after{width:75%;left:12.5%}.rr--dir-x.rr--gap-lg .rr--svg{margin:0 25%}.rr--dir-x.rr--gap-lg .rr--box:focus-visible:after{width:50%;left:25%}.rr--dir-y.rr--gap-sm .rr--svg{margin:6.25% 0}.rr--dir-y.rr--gap-md .rr--svg{margin:12.5% 0}.rr--dir-y.rr--gap-lg .rr--svg{margin:25% 0}.rr--rx-sm .rr--svg{border-radius:5%}.rr--rx-md .rr--svg{border-radius:15%}.rr--rx-lg .rr--svg{border-radius:20%}.rr--rx-full .rr--svg{border-radius:100%}.rr--has-stroke .rr--svg{stroke-linecap:round;stroke-linejoin:round}.rr--has-border .rr--svg{border-width:var(--rr--border-width);border-style:solid}.rr--on .rr--svg{fill:var(--rr--fill-on-color, none)}.rr--off .rr--svg{fill:var(--rr--fill-off-color, none)}.rr--has-stroke .rr--on .rr--svg{stroke:var(--rr--stroke-on-color, currentColor)}.rr--has-stroke .rr--off .rr--svg{stroke:var(--rr--stroke-off-color, currentColor)}.rr--on .rr--svg{background-color:var(--rr--box-on-color, none)}.rr--off .rr--svg{background-color:var(--rr--box-off-color, none)}.rr--has-border .rr--off .rr--svg{border-color:var(--rr--border-off-color, currentColor)}.rr--has-border .rr--on .rr--svg{border-color:var(--rr--border-on-color, currentColor)}.rr--fx-colors{--rr--easing: .2s cubic-bezier(.61, 1, .88, 1)}.rr--fx-colors .rr--svg{transition-duration:.2s;transition-timing-function:var(--rr--easing);transition-property:background-color,border-color,fill,stroke}.rr--fx-opacity .rr--off{opacity:.35;transition:opacity var(--rr--easing)}.rr--fx-opacity .rr--on{opacity:1}@media(hover: hover){.rr--fx-opacity .rr--box:hover{opacity:1}}@media(hover: hover){.rr--fx-zoom .rr--box{transition:transform var(--rr--easing);transform:scale(1)}.rr--fx-zoom .rr--box:hover{transform:scale(1.2)}}@media(hover: hover)and (prefers-reduced-motion){.rr--fx-zoom .rr--box:hover{transform:scale(1)}}@media(hover: hover){.rr--fx-position .rr--box{transition:transform var(--rr--easing);transform:translateY(0)}.rr--fx-position .rr--box:hover{transform:translateY(-15%)}}@media(hover: hover)and (prefers-reduced-motion){.rr--fx-position .rr--box:hover{transform:translateY(0)}}.rr--svg-stop-1{stop-color:var(--rr--fill-on-color, rgba(0, 0, 0, 0))}[dir=rtl] .rr--svg-stop-1,.rr--svg-stop-2{stop-color:var(--rr--fill-off-color, rgba(0, 0, 0, 0))}[dir=rtl] .rr--svg-stop-2{stop-color:var(--rr--fill-on-color, rgba(0, 0, 0, 0))}.rr--hf-svg-on{fill:var(--rr--fill-on-color, none)}.rr--hf-svg-off{fill:var(--rr--fill-off-color, none)}.rr--has-stroke .rr--hf-svg-on{stroke:var(--rr--stroke-on-color, currentColor)}.rr--has-stroke .rr--hf-svg-off{stroke:var(--rr--stroke-off-color, currentColor)}.rr--hf-svg-on .rr--svg,.rr--hf-svg-off .rr--svg{background-color:var(--rr--box-off-color, none)}.rr--has-border .rr--hf-svg-on .rr--svg{border-color:var(--rr--border-on-color, currentColor)}.rr--has-border .rr--hf-svg-off .rr--svg{border-color:var(--rr--border-off-color, currentColor)}.rr--dir-x .rr--hf-box-int .rr--svg{background:linear-gradient(to right, var(--rr--box-on-color, none) 50%, var(--rr--box-off-color, none) 50%)}[dir=rtl] .rr--dir-x .rr--hf-box-int .rr--svg{background:linear-gradient(to left, var(--rr--box-on-color, none) 50%, var(--rr--box-off-color, none) 50%)}.rr--dir-y .rr--hf-box-int .rr--svg{background:linear-gradient(to bottom, var(--rr--box-on-color, none) 50%, var(--rr--box-off-color, none) 50%)}.rr--hf-box-on .rr--svg{background-color:var(--rr--box-on-color, none)}.rr--hf-box-off .rr--svg{background-color:var(--rr--box-off-color, none)}.rr--hf-box-on .rr--svg,.rr--hf-box-off .rr--svg,.rr--hf-box-int .rr--svg{fill:var(--rr--fill-off-color, none)}.rr--has-stroke .rr--hf-box-on .rr--svg,.rr--has-stroke .rr--hf-box-off .rr--svg,.rr--has-stroke .rr--hf-box-int .rr--svg{stroke:var(--rr--stroke-off-color, currentColor)}.rr--has-border .rr--hf-box-on .rr--svg,.rr--has-border .rr--hf-box-int .rr--svg{border-color:var(--rr--border-on-color, currentColor)}.rr--has-border .rr--hf-box-off .rr--svg{border-color:var(--rr--border-off-color, currentColor)}</style><style>.kw-overview-container{box-sizing:border-box;width:673px;padding:0;margin:0;margin-top:14px;font-size:12px;font-family:Figtree;-webkit-font-smoothing:antialiased}.kw-overview-container.youtube{box-sizing:border-box;width:645px;padding:0;margin:0;font-size:12px}</style></head>
<body class="text-slate-700 summary-mode">

    <nav class="bg-white border-b border-slate-100 sticky top-0 z-40 shadow-sm">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6">
                        <div class="flex justify-between h-16 items-center">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center">
                                    <span class="material-symbols-outlined text-white text-xl">school</span>
                                </div>
                                <div class="flex flex-col">
                                    <div class="font-bold text-lg text-slate-900">StudyEngine</div>
                                    <div class="text-xs text-slate-500 hidden sm:block">è‹±èªå­¸ç¿’å¹³å°</div>
                                </div>
                            </div>
                            
                            <div class="relative">
                                <button onclick="toggleExportMenu()" class="px-3 py-2 rounded-lg border border-purple-200 bg-purple-50 hover:bg-purple-100 text-purple-700 transition text-sm font-medium flex items-center gap-1.5">
                                    <span class="material-symbols-outlined text-lg">bookmark</span>
                                    <span class="hidden sm:inline">Export Words (</span><span class="sm:hidden">(</span><span id="selected-count">0</span><span>)</span>
                                </button>
                                <div id="export-menu" class="hidden absolute top-full right-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 min-w-max overflow-hidden">
                                    <button onclick="copyExportPrompt()" class="w-full px-4 py-2.5 text-left hover:bg-blue-50 border-b border-slate-100 flex items-center gap-2 text-sm" title="è¤‡è£½ç”ŸæˆAIæŒ‡ä»¤çš„Prompt">
                                        <span class="material-symbols-outlined text-sm text-blue-600">content_copy</span> <span>è¤‡è£½ Prompt</span>
                                    </button>
                                    <button onclick="exportSelectedWords()" class="w-full px-4 py-2.5 text-left hover:bg-blue-50 flex items-center gap-2 text-sm" title="ä¸‹è¼‰é¸ä¸­çš„ç”Ÿå­—">
                                        <span class="material-symbols-outlined text-sm text-blue-600">download</span> <span>ä¸‹è¼‰æ–‡å­—æª”</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </nav>

    <div class="max-w-7xl mx-auto px-6 py-8 pb-32 space-y-8">
        
        <!-- Video Section (Will be included in export) -->
        <section id="video-section" class="bg-white rounded-2xl p-8 shadow-sm border border-slate-100 learning-card">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold flex items-center gap-3 text-slate-900">
                    <div class="p-2 bg-red-100 rounded-lg">
                        <span class="material-symbols-outlined text-red-600 text-2xl">play_circle</span>
                    </div>
                    å½±ç‰‡æ’­æ”¾
                </h3>
                <div class="flex items-center gap-2">
                    <button onclick="openModal('video')" class="px-4 py-2 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 text-slate-700 text-sm font-medium transition flex items-center gap-2">
                        <span class="material-symbols-outlined text-base">edit</span> æ›´æ›å½±ç‰‡
                    </button>
                    <button onclick="manualToggleSticky()" class="px-4 py-2 rounded-lg border border-blue-200 bg-blue-50 hover:bg-blue-100 text-blue-700 text-sm font-medium transition flex items-center gap-2" title="åˆ‡æ›æµ®å‹•æ¨¡å¼">
                        <span class="material-symbols-outlined text-base">picture_in_picture_alt</span> æµ®å‹•
                    </button>
                </div>
            </div>
            <div id="video-container" class="relative w-full bg-black rounded-xl overflow-hidden" style="padding-top: 56.25%;">
                <div id="player" class="absolute inset-0"></div>
                <button id="close-sticky-video" class="absolute top-2 right-2 z-10 p-1.5 bg-black/70 hover:bg-black/90 rounded-lg text-white transition hidden">
                </button>
            </div>
            <div id="video-placeholder" class="w-full hidden" style="padding-top: 30%;"></div>
            <p class="text-sm text-slate-600 mt-3">
                é»æ“Šæ™‚é–“æ¨™ç±¤è·³è½‰åˆ°æŒ‡å®šæ™‚é–“
            </p>
        </section>

        <!-- Floating close button -->
        <button id="floating-close-btn" class="p-2 bg-white/95 hover:bg-white rounded-full text-slate-700 hover:text-slate-900 shadow-lg hover:shadow-xl transition-all hover:scale-110 hidden">
            <span class="material-symbols-outlined text-xl">close</span>
        </button>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Transcript -->
            <main class="lg:w-2/3 bg-white p-8 rounded-2xl shadow-lg">
                <div class="flex justify-between items-center mb-6 border-b pb-4">
                    <h2 id="transcript-title" class="text-2xl font-bold text-slate-900">æ‘˜è¦ï¼ˆB1ï¼‰</h2>
                    <button onclick="toggleTranslations()" class="px-3 py-2 rounded-lg border border-slate-200 bg-slate-50 hover:bg-slate-100 text-slate-600 text-sm font-medium transition flex items-center gap-2">
                        <span class="material-symbols-outlined text-base">translate</span> <span id="toggle-btn-text">é¡¯ç¤ºä¸­æ–‡</span>
                    </button>
                </div>
                
                <div id="transcript-content" class="space-y-8 text-lg leading-relaxed text-slate-700">
                    <div class="mb-6" id="seg-0">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(0)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-0" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(0)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(0)">
                                âµ 00:00
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-0" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="0" onchange="setTimeByInput(0)" onkeypress="if(event.key==='Enter') setTimeByInput(0)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-0" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="" onchange="setTimeByInput(0)" onkeypress="if(event.key==='Enter') setTimeByInput(0)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(0)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-0">In 2015, a photo of a dress became very famous on the internet. Some people saw the dress as blue and black. Others saw it as white and gold. This simple picture shocked everyone. Why? Because it showed us a big truth: two people can look at the same reality but <span class="vocab-word" data-id="perceive" onmouseenter="showCard(event, 'perceive')" onmouseleave="hideCard()" onclick="toggleCard(event, 'perceive')">perceive</span> it completely differently.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-0">2015å¹´ï¼Œä¸€å¼µæ´‹è£çš„ç…§ç‰‡åœ¨ç¶²è·¯ä¸Šè®Šå¾—éå¸¸æœ‰åã€‚æœ‰äº›äººçœ‹åˆ°çš„æ˜¯è—é»‘è‰²ï¼Œå…¶ä»–äººçœ‹åˆ°çš„å‰‡æ˜¯ç™½é‡‘è‰²ã€‚é€™å¼µç°¡å–®çš„ç…§ç‰‡éœ‡é©šäº†æ‰€æœ‰äººã€‚ç‚ºä»€éº¼ï¼Ÿå› ç‚ºå®ƒå‘æˆ‘å€‘å±•ç¤ºäº†ä¸€å€‹é‡è¦çš„çœŸç›¸ï¼šå…©å€‹äººçœ‹è‘—åŒæ¨£çš„ç¾å¯¦ï¼Œå»å¯èƒ½æœ‰å®Œå…¨ä¸åŒçš„æ„ŸçŸ¥ã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-1">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(1)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-1" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(1)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(10)">
                                âµ 00:10
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-1" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="0" onchange="setTimeByInput(1)" onkeypress="if(event.key==='Enter') setTimeByInput(1)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-1" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="10" onchange="setTimeByInput(1)" onkeypress="if(event.key==='Enter') setTimeByInput(1)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(1)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-1">I want to talk about two main ideas today. First, our minds are more different than we think. Second, you should work with people who think differently than you because that is how we create magic.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-1">ä»Šå¤©æˆ‘æƒ³è«‡è«‡å…©å€‹ä¸»è¦è§€é»ã€‚é¦–å…ˆï¼Œæˆ‘å€‘çš„å¿ƒæ™ºå·®ç•°æ¯”æˆ‘å€‘æƒ³åƒçš„é‚„è¦å¤§ã€‚å…¶æ¬¡ï¼Œä½ æ‡‰è©²èˆ‡æ€è€ƒæ–¹å¼ä¸åŒçš„äººåˆä½œï¼Œå› ç‚ºé€™æ­£æ˜¯æˆ‘å€‘å‰µé€ å¥‡è¹Ÿçš„æ–¹å¼ã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-2">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(2)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-2" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(2)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(20)">
                                âµ 00:20
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-2" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="0" onchange="setTimeByInput(2)" onkeypress="if(event.key==='Enter') setTimeByInput(2)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-2" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="20" onchange="setTimeByInput(2)" onkeypress="if(event.key==='Enter') setTimeByInput(2)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(2)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-2">I work as a writer and a game designer. A few years ago, I realized that my brain works differently from most people. Letâ€™s try a small experiment. Please close your eyes and <span class="vocab-word" data-id="visualize" onmouseenter="showCard(event, 'visualize')" onmouseleave="hideCard()" onclick="toggleCard(event, 'visualize')">visualize</span> this: A rocket ship lands on an alien planet. A creature knocks on the door, and someone opens it.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-2">æˆ‘çš„è·æ¥­æ˜¯ä½œå®¶å’ŒéŠæˆ²è¨­è¨ˆå¸«ã€‚å¹¾å¹´å‰ï¼Œæˆ‘æ„è­˜åˆ°æˆ‘çš„å¤§è…¦é‹ä½œæ–¹å¼èˆ‡å¤§å¤šæ•¸äººä¸åŒã€‚è®“æˆ‘å€‘ä¾†åšå€‹å°å¯¦é©—ã€‚è«‹é–‰ä¸Šçœ¼ç›ä¸¦æƒ³åƒé€™å€‹ç•«é¢ï¼šä¸€è‰˜ç«ç®­é™è½åœ¨å¤–æ˜Ÿçƒä¸Šã€‚ä¸€å€‹ç”Ÿç‰©æ•²äº†æ•²é–€ï¼Œç„¶å¾Œæœ‰äººæ‰“é–‹äº†é–€ã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-3">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(3)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-3" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(3)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(30)">
                                âµ 00:30
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-3" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="0" onchange="setTimeByInput(3)" onkeypress="if(event.key==='Enter') setTimeByInput(3)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-3" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="30" onchange="setTimeByInput(3)" onkeypress="if(event.key==='Enter') setTimeByInput(3)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(3)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-3">Now, answer these questions: What color was the planet? What did the creature look like? Here is what I see when I do this exercise: Nothing.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-3">ç¾åœ¨ï¼Œå›ç­”é€™äº›å•é¡Œï¼šé‚£å€‹æ˜Ÿçƒæ˜¯ä»€éº¼é¡è‰²çš„ï¼Ÿé‚£å€‹ç”Ÿç‰©é•·ä»€éº¼æ¨£å­ï¼Ÿç•¶æˆ‘åšé€™å€‹ç·´ç¿’æ™‚ï¼Œæˆ‘çœ‹åˆ°çš„æ˜¯ï¼šä¸€ç‰‡ç©ºç™½ï¼ˆä»€éº¼éƒ½æ²’æœ‰ï¼‰ã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-4">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(4)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-4" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(4)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(40)">
                                âµ 00:40
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-4" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="0" onchange="setTimeByInput(4)" onkeypress="if(event.key==='Enter') setTimeByInput(4)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-4" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="40" onchange="setTimeByInput(4)" onkeypress="if(event.key==='Enter') setTimeByInput(4)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(4)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-4">I have a condition called "<span class="vocab-word" data-id="aphantasia" onmouseenter="showCard(event, 'aphantasia')" onmouseleave="hideCard()" onclick="toggleCard(event, 'aphantasia')">aphantasia</span>." This means I do not have a "mindâ€™s eye." I cannot see pictures in my head. Human imagination is like a <span class="vocab-word" data-id="spectrum" onmouseenter="showCard(event, 'spectrum')" onmouseleave="hideCard()" onclick="toggleCard(event, 'spectrum')">spectrum</span> (a range). On one side, some people have "<span class="vocab-word" data-id="hyperphantasia" onmouseenter="showCard(event, 'hyperphantasia')" onmouseleave="hideCard()" onclick="toggleCard(event, 'hyperphantasia')">hyperphantasia</span>" and can see perfect images in their minds. On the other side, about 2% to 4% of people are like me. We see nothing.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-4">æˆ‘æœ‰ä¸€ç¨®ç¨±ç‚ºã€Œç„¡æƒ³åƒåŠ›ç—‡ã€ï¼ˆaphantasiaï¼Œæˆ–ç¨±å¿ƒç›²ç—‡ï¼‰çš„ç‹€æ³ã€‚é€™æ„å‘³è‘—æˆ‘æ²’æœ‰ã€Œå¿ƒéˆä¹‹çœ¼ã€ï¼Œæˆ‘ç„¡æ³•åœ¨è…¦æµ·ä¸­çœ‹åˆ°ç•«é¢ã€‚äººé¡çš„æƒ³åƒåŠ›å°±åƒä¸€å€‹å…‰è­œï¼ˆç¯„åœï¼‰ã€‚åœ¨ä¸€ç«¯ï¼Œæœ‰äº›äººæ“æœ‰ã€Œè¶…å¼·æƒ³åƒåŠ›ã€ï¼Œå¯ä»¥åœ¨è…¦æµ·ä¸­çœ‹åˆ°å®Œç¾çš„åœ–åƒã€‚åœ¨å¦ä¸€ç«¯ï¼Œå¤§ç´„ 2% åˆ° 4% çš„äººåƒæˆ‘ä¸€æ¨£ï¼Œæˆ‘å€‘ä»€éº¼ä¹Ÿçœ‹ä¸åˆ°ã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-5">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(5)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-5" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(5)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(50)">
                                âµ 00:50
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-5" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="0" onchange="setTimeByInput(5)" onkeypress="if(event.key==='Enter') setTimeByInput(5)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-5" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="50" onchange="setTimeByInput(5)" onkeypress="if(event.key==='Enter') setTimeByInput(5)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(5)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-5">For a long time, I thought everyone was like me. When people said, "I can see it in my mind," I thought it was just a figure of speech. When I learned about <span class="vocab-word" data-id="aphantasia" onmouseenter="showCard(event, 'aphantasia')" onmouseleave="hideCard()" onclick="toggleCard(event, 'aphantasia')">aphantasia</span>, I was scared. I thought, "Am I in the wrong job?"</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-5">å¾ˆé•·ä¸€æ®µæ™‚é–“ï¼Œæˆ‘ä»¥ç‚ºæ¯å€‹äººéƒ½è·Ÿæˆ‘ä¸€æ¨£ã€‚ç•¶äººå€‘èªªã€Œæˆ‘å¯ä»¥åœ¨è…¦æµ·ä¸­çœ‹åˆ°å®ƒã€æ™‚ï¼Œæˆ‘ä»¥ç‚ºé‚£åªæ˜¯å€‹æ¯”å–»ã€‚ç•¶æˆ‘å¾—çŸ¥ç„¡æƒ³åƒåŠ›ç—‡æ™‚ï¼Œæˆ‘æ„Ÿåˆ°å¾ˆå®³æ€•ã€‚æˆ‘æƒ³ï¼šã€Œæˆ‘æ˜¯ä¸æ˜¯å…¥éŒ¯è¡Œäº†ï¼Ÿã€</p>
                    </div>
                    <div class="mb-6" id="seg-6">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(6)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-6" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(6)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(60)">
                                âµ 01:00
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-6" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="1" onchange="setTimeByInput(6)" onkeypress="if(event.key==='Enter') setTimeByInput(6)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-6" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="" onchange="setTimeByInput(6)" onkeypress="if(event.key==='Enter') setTimeByInput(6)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(6)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-6">This condition changes how I process information. For example, when most people read a book, they see a movie in their heads. I cannot do that. For me, reading is a <span class="vocab-word" data-id="conceptual" onmouseenter="showCard(event, 'conceptual')" onmouseleave="hideCard()" onclick="toggleCard(event, 'conceptual')">conceptual</span> experience. I understand the ideas, but I donâ€™t see the scenes. This also affects my memory. I have a five-year-old daughter, but when I am not looking at her, I cannot see her face in my mind.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-6">é€™å€‹ç‹€æ³æ”¹è®Šäº†æˆ‘è™•ç†è³‡è¨Šçš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œç•¶å¤§å¤šæ•¸äººé–±è®€å°èªªæ™‚ï¼Œä»–å€‘è…¦ä¸­æœƒåƒåœ¨çœ‹é›»å½±ã€‚æˆ‘ç„¡æ³•é‚£æ¨£åšã€‚å°æˆ‘ä¾†èªªï¼Œé–±è®€æ˜¯ä¸€ç¨®æ¦‚å¿µæ€§çš„é«”é©—ã€‚æˆ‘ç†è§£é€™äº›æƒ³æ³•ï¼Œä½†çœ‹ä¸åˆ°å ´æ™¯ã€‚é€™ä¹Ÿå½±éŸ¿äº†æˆ‘çš„è¨˜æ†¶ã€‚æˆ‘æœ‰å€‹äº”æ­²çš„å¥³å…’ï¼Œä½†ç•¶æˆ‘æ²’çœ‹è‘—å¥¹æ™‚ï¼Œæˆ‘ç„¡æ³•åœ¨è…¦æµ·ä¸­æµ®ç¾å¥¹çš„è‡‰é¾ã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-7">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(7)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-7" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(7)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(70)">
                                âµ 01:10
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-7" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="1" onchange="setTimeByInput(7)" onkeypress="if(event.key==='Enter') setTimeByInput(7)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-7" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="10" onchange="setTimeByInput(7)" onkeypress="if(event.key==='Enter') setTimeByInput(7)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(7)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-7">So, how do I design games if I cannot imagine pictures? I focus on the structureâ€”the "skeleton"â€”rather than the "skin." I think about the rules and the story first. Then, I work with amazing artists who can <span class="vocab-word" data-id="visualize" onmouseenter="showCard(event, 'visualize')" onmouseleave="hideCard()" onclick="toggleCard(event, 'visualize')">visualize</span> the details.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-7">é‚£éº¼ï¼Œå¦‚æœæˆ‘ç„¡æ³•æƒ³åƒç•«é¢ï¼Œæˆ‘è¦å¦‚ä½•è¨­è¨ˆéŠæˆ²å‘¢ï¼Ÿæˆ‘å°ˆæ³¨æ–¼çµæ§‹â€”â€”ä¹Ÿå°±æ˜¯ã€Œéª¨æ¶ã€â€”â€”è€Œä¸æ˜¯ã€Œçš®è†šã€ã€‚æˆ‘å…ˆæ§‹æ€è¦å‰‡å’Œæ•…äº‹ã€‚ç„¶å¾Œï¼Œæˆ‘èˆ‡é‚£äº›èƒ½å¤ å°‡ç´°ç¯€å…·è±¡åŒ–çš„å„ªç§€è—è¡“å®¶åˆä½œã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-8">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(8)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-8" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(8)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(80)">
                                âµ 01:20
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-8" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="1" onchange="setTimeByInput(8)" onkeypress="if(event.key==='Enter') setTimeByInput(8)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-8" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="20" onchange="setTimeByInput(8)" onkeypress="if(event.key==='Enter') setTimeByInput(8)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(8)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-8">This experience taught me something important. <span class="vocab-word" data-id="aphantasia" onmouseenter="showCard(event, 'aphantasia')" onmouseleave="hideCard()" onclick="toggleCard(event, 'aphantasia')">Aphantasia</span> is just one example of <span class="vocab-word" data-id="neurological" onmouseenter="showCard(event, 'neurological')" onmouseleave="hideCard()" onclick="toggleCard(event, 'neurological')">neurological</span> diversity. There are many other types, like autism, ADHD, and <span class="vocab-word" data-id="dyslexia" onmouseenter="showCard(event, 'dyslexia')" onmouseleave="hideCard()" onclick="toggleCard(event, 'dyslexia')">dyslexia</span>. Society often treats these as illnesses or problems. I think that is wrong. There is no "normal" brain. Being different is not bad.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-8">é€™æ¬¡ç¶“æ­·æ•™æœƒäº†æˆ‘ä¸€ä»¶é‡è¦çš„äº‹ã€‚ç„¡æƒ³åƒåŠ›ç—‡åªæ˜¯ç¥ç¶“å¤šæ¨£æ€§çš„ä¸€å€‹ä¾‹å­ã€‚é‚„æœ‰è¨±å¤šå…¶ä»–é¡å‹ï¼Œå¦‚è‡ªé–‰ç—‡ã€ADHDï¼ˆæ³¨æ„åŠ›ä¸è¶³éå‹•ç—‡ï¼‰å’Œé–±è®€éšœç¤™ã€‚ç¤¾æœƒé€šå¸¸å°‡é€™äº›è¦–ç‚ºç–¾ç—…æˆ–å•é¡Œã€‚æˆ‘èªç‚ºé€™æ˜¯éŒ¯çš„ã€‚ä¸¦æ²’æœ‰æ‰€è¬‚ã€Œæ­£å¸¸ã€çš„å¤§è…¦ã€‚èˆ‡çœ¾ä¸åŒä¸¦ä¸æ˜¯å£äº‹ã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-9">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(9)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-9" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(9)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(90)">
                                âµ 01:30
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-9" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="1" onchange="setTimeByInput(9)" onkeypress="if(event.key==='Enter') setTimeByInput(9)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-9" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="30" onchange="setTimeByInput(9)" onkeypress="if(event.key==='Enter') setTimeByInput(9)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(9)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-9">In fact, research shows that teams with different types of people produce better results. Companies are starting to hire people who think differently, and they are seeing great success. In my career, I work with artists who have powerful visual imaginations. Because our minds are different, we make wonderful things together.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-9">äº‹å¯¦ä¸Šï¼Œç ”ç©¶é¡¯ç¤ºç”±ä¸åŒé¡å‹çš„äººçµ„æˆçš„åœ˜éšŠèƒ½ç”¢ç”Ÿæ›´å¥½çš„çµæœã€‚ä¼æ¥­é–‹å§‹åƒ±ç”¨æ€è€ƒæ–¹å¼ä¸åŒçš„äººï¼Œä¸¦ä¸”çœ‹è¦‹äº†å·¨å¤§çš„æˆåŠŸã€‚åœ¨æˆ‘çš„è·æ¥­ç”Ÿæ¶¯ä¸­ï¼Œæˆ‘èˆ‡æ“æœ‰å¼·å¤§è¦–è¦ºæƒ³åƒåŠ›çš„è—è¡“å®¶åˆä½œã€‚æ­£å› ç‚ºæˆ‘å€‘çš„å¿ƒæ™ºä¸åŒï¼Œæˆ‘å€‘ä¸€èµ·å‰µé€ äº†ç¾å¦™çš„äº‹ç‰©ã€‚</p>
                    </div>
                    <div class="mb-6" id="seg-10">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            <div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" onclick="speakSegment(10)" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-10" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" onclick="togglePauseSegment(10)" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 bg-green-50 text-green-700 text-xs font-semibold transition-colors" onclick="jumpToTime(100)">
                                âµ 01:40
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-10" min="0" max="999" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0" value="1" onchange="setTimeByInput(10)" onkeypress="if(event.key==='Enter') setTimeByInput(10)">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-10" min="0" max="59" step="1" class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="00" value="40" onchange="setTimeByInput(10)" onkeypress="if(event.key==='Enter') setTimeByInput(10)">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" onclick="editSegment(10)">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-10">So, am I in the wrong field? No. I realized that my different mind is not a weakness. It is a gift. We should all look for minds that are different from ours. When we combine our different ways of thinking, we can do incredible things.</p>
                        <p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-10">æ‰€ä»¥ï¼Œæˆ‘å…¥éŒ¯è¡Œäº†å—ï¼Ÿä¸ã€‚æˆ‘æ„è­˜åˆ°æˆ‘ç¨ç‰¹çš„å¿ƒæ™ºä¸æ˜¯å¼±é»ï¼Œè€Œæ˜¯ç¦®ç‰©ã€‚æˆ‘å€‘éƒ½æ‡‰è©²å°‹æ‰¾èˆ‡æˆ‘å€‘ä¸åŒçš„å¿ƒæ™ºã€‚ç•¶æˆ‘å€‘çµåˆå½¼æ­¤ä¸åŒçš„æ€è€ƒæ–¹å¼æ™‚ï¼Œæˆ‘å€‘å°±èƒ½æˆå°±ä¸å¯æ€è­°çš„äº‹ã€‚</p>
                    </div></div>
            </main>

            <!-- Vocab + Quiz Sidebar -->
            <aside class="lg:w-1/3">
                <div class="sticky top-24 space-y-6">
                    <div class="bg-white rounded-2xl shadow-sm border border-slate-100 learning-card p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="font-bold text-xl flex items-center gap-3 text-slate-900">
                                <div class="p-2 bg-amber-100 rounded-lg">
                                    <span class="material-symbols-outlined text-amber-600 text-2xl">verified</span>
                                </div>
                                è©å½™è¡¨
                                <span class="text-sm bg-slate-200 px-2.5 py-1 rounded-full font-semibold" id="vocab-count">8</span>
                            </h3>
                            <button onclick="showAddVocabModal()" class="text-blue-600 hover:bg-blue-50 rounded-full p-2 transition hover:scale-110" title="æ–°å¢ç”Ÿå­—">
                                <span class="material-symbols-outlined text-2xl">add_circle</span>
                            </button>
                        </div>
                        <ul id="vocab-list" class="divide-y max-h-[60vh] overflow-y-auto">
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" onclick="scrollToVocab('aphantasia')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">1.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">Aphantasia</div>
                                    <button onclick="event.stopPropagation(); speakWord('Aphantasia')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                <div class="text-xs text-blue-600 font-semibold mt-1">/ËŒeÉª.fÃ¦nËˆteÉª.Ê’É™/</div>
                                <div class="text-xs text-slate-500 mt-0.5">noun</div>
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">A condition where a person cannot voluntarily create mental images in their mind.</div>
                        <div class="text-xs text-blue-700 font-semibold ml-6">ç„¡æƒ³åƒåŠ›ç—‡ (åˆç¨±å¿ƒç›²ç—‡)</div>
                    </li>
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" onclick="scrollToVocab('conceptual')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">2.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">Conceptual</div>
                                    <button onclick="event.stopPropagation(); speakWord('Conceptual')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                <div class="text-xs text-blue-600 font-semibold mt-1">/kÉ™nËˆsep.tÊƒu.É™l/</div>
                                <div class="text-xs text-slate-500 mt-0.5">adjective</div>
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">Based on ideas or principles rather than concrete examples or physical reality.</div>
                        <div class="text-xs text-blue-700 font-semibold ml-6">æ¦‚å¿µä¸Šçš„ï¼›è§€å¿µçš„</div>
                    </li>
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" onclick="scrollToVocab('dyslexia')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">3.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">Dyslexia</div>
                                    <button onclick="event.stopPropagation(); speakWord('Dyslexia')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                <div class="text-xs text-blue-600 font-semibold mt-1">/dÉªsËˆlek.si.É™/</div>
                                <div class="text-xs text-slate-500 mt-0.5">noun</div>
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">A learning disorder that affects a person's ability to read, write, and spell.</div>
                        <div class="text-xs text-blue-700 font-semibold ml-6">é–±è®€éšœç¤™</div>
                    </li>
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" onclick="scrollToVocab('hyperphantasia')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">4.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">Hyperphantasia</div>
                                    <button onclick="event.stopPropagation(); speakWord('Hyperphantasia')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                <div class="text-xs text-blue-600 font-semibold mt-1">/ËŒhaÉª.pÉ™r.fÃ¦nËˆteÉª.Ê’É™/</div>
                                <div class="text-xs text-slate-500 mt-0.5">noun</div>
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">The condition of having extremely vivid mental imagery.</div>
                        <div class="text-xs text-blue-700 font-semibold ml-6">è¶…å¼·æƒ³åƒåŠ› (å¿ƒåƒæ¥µåº¦æ¸…æ™°)</div>
                    </li>
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" onclick="scrollToVocab('neurological')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">5.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">Neurological</div>
                                    <button onclick="event.stopPropagation(); speakWord('Neurological')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                <div class="text-xs text-blue-600 font-semibold mt-1">/ËŒnÊŠr.É™ËˆlÉ‘Ë.dÊ’Éª.kÉ™l/</div>
                                <div class="text-xs text-slate-500 mt-0.5">adjective</div>
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">Relating to the anatomy, functions, and organic disorders of nerves and the nervous system.</div>
                        <div class="text-xs text-blue-700 font-semibold ml-6">ç¥ç¶“å­¸çš„ï¼›ç¥ç¶“ç³»çµ±çš„</div>
                    </li>
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" onclick="scrollToVocab('perceive')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">6.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">Perceive</div>
                                    <button onclick="event.stopPropagation(); speakWord('Perceive')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                <div class="text-xs text-blue-600 font-semibold mt-1">/pÉ™rËˆsiËv/</div>
                                <div class="text-xs text-slate-500 mt-0.5">verb</div>
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">To interpret or become aware of something through the senses or the mind.</div>
                        <div class="text-xs text-blue-700 font-semibold ml-6">æ„ŸçŸ¥ï¼›å¯Ÿè¦ºï¼›ç†è§£</div>
                    </li>
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" onclick="scrollToVocab('spectrum')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">7.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">Spectrum</div>
                                    <button onclick="event.stopPropagation(); speakWord('Spectrum')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                <div class="text-xs text-blue-600 font-semibold mt-1">/Ëˆspek.trÉ™m/</div>
                                <div class="text-xs text-slate-500 mt-0.5">noun</div>
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">A range of different positions, opinions, or values between two extreme points.</div>
                        <div class="text-xs text-blue-700 font-semibold ml-6">å…‰è­œï¼›ç¯„åœï¼›å¹…åº¦</div>
                    </li>
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" onclick="scrollToVocab('visualize')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">8.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">Visualize</div>
                                    <button onclick="event.stopPropagation(); speakWord('Visualize')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                <div class="text-xs text-blue-600 font-semibold mt-1">/ËˆvÉªÊ’.u.É™.laÉªz/</div>
                                <div class="text-xs text-slate-500 mt-0.5">verb</div>
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">To form a mental image of something; to imagine.</div>
                        <div class="text-xs text-blue-700 font-semibold ml-6">æƒ³åƒï¼›åœ¨è…¦æµ·ä¸­é¡¯ç¾åœ–åƒ</div>
                    </li></ul>
                    </div>
                    
                    <div class="bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-600 rounded-2xl p-8 shadow-lg text-white learning-card">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="p-2 bg-white/20 rounded-lg">
                                <span class="material-symbols-outlined text-2xl">quiz</span>
                            </div>
                            <h3 class="font-bold text-xl">çŸ¥è­˜æª¢æ¸¬</h3>
                        </div>
                        <p class="text-blue-100 text-sm mb-6 leading-relaxed">é€šéæ¸¬é©—éå›ºæ‰€å­¸ï¼Œè©•ä¼°å­¸ç¿’é€²åº¦ã€‚</p>
                        <button onclick="openQuiz()" class="w-full bg-white text-blue-600 py-3 px-4 rounded-xl font-bold shadow-md hover:shadow-lg hover:bg-blue-50 transition transform hover:scale-[1.02] flex justify-center items-center gap-2">
                            <span class="material-symbols-outlined">play_circle</span>
                            <span>é–‹å§‹æ¸¬é©—</span>
                        </button>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- Mobile Floating Action Button for Quiz -->
    <button onclick="openQuiz()" class="lg:hidden fixed bottom-20 right-6 bg-gradient-to-br from-blue-500 to-indigo-600 text-white p-4 rounded-full shadow-xl hover:shadow-2xl hover:scale-110 z-50 flex items-center justify-center transition">
        <span class="material-symbols-outlined text-2xl">quiz</span>
    </button>

    <!-- Bottom Control Bar (Will be kept in export) -->
    <div id="bottom-controls" class="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 shadow-lg z-40 px-3 py-3">
        <div class="flex flex-nowrap justify-center gap-2">
            <button id="play-pause-btn" onclick="togglePlayPause()" class="flex items-center gap-1.5 px-4 py-3 rounded-lg bg-gradient-to-r from-red-500 to-red-600 text-white font-semibold shadow-md hover:shadow-lg active:scale-95 transition-all min-h-[44px]">
                <span class="material-symbols-outlined text-xl" id="play-icon">play_arrow</span>
                <span id="play-text" class="hidden sm:inline text-sm">æ’­æ”¾</span>
            </button>
            
            <div class="flex items-center rounded-xl border border-slate-300 bg-slate-100 overflow-hidden min-h-[44px]">
                <button onclick="decreaseFontSize()" class="px-3 py-3 text-sm text-slate-700 hover:bg-slate-200 active:bg-slate-300 transition">
                    <span class="material-symbols-outlined text-lg">text_decrease</span>
                </button>
                <div class="w-px h-8 bg-slate-300"></div>
                <button onclick="increaseFontSize()" class="px-3 py-3 text-sm text-slate-700 hover:bg-slate-200 active:bg-slate-300 transition">
                    <span class="material-symbols-outlined text-lg">text_increase</span>
                </button>
            </div>
            
            <div class="flex items-center rounded-xl border border-slate-300 bg-white overflow-hidden min-h-[44px]">
                <button onclick="decreasePlaybackSpeed()" class="px-3 py-3 text-sm text-slate-700 hover:bg-slate-100 active:bg-slate-200 transition">
                    <span class="material-symbols-outlined text-lg">remove</span>
                </button>
                <div class="w-px h-8 bg-slate-300"></div>
                <div class="flex items-center px-3 py-3 text-sm font-bold min-w-[50px] justify-center text-slate-700">
                    <span id="speed-display">1.0x</span>
                </div>
                <div class="w-px h-8 bg-slate-300"></div>
                <button onclick="increasePlaybackSpeed()" class="px-3 py-3 text-sm text-slate-700 hover:bg-slate-100 active:bg-slate-200 transition">
                    <span class="material-symbols-outlined text-lg">add</span>
                </button>
            </div>
            
            <button onclick="toggleTranslations()" class="flex items-center px-4 py-3 rounded-lg border border-blue-300 bg-blue-50 text-blue-700 text-sm font-medium active:bg-blue-100 hover:bg-blue-100 transition min-h-[44px]">
                <span class="material-symbols-outlined text-lg">translate</span> <span id="cn-toggle-text">ä¸­æ–‡</span>
            </button>
            <button onclick="resetSettings()" class="hidden sm:block px-4 py-3 rounded-lg border border-slate-300 bg-slate-50 text-slate-600 text-sm font-medium hover:bg-slate-100 active:bg-slate-200 transition min-h-[44px]">
                <span class="material-symbols-outlined text-lg">restart_alt</span>
            </button>
        </div>
    </div>

    <!-- Floating Card -->
    <div id="floating-card" class="fixed bg-white rounded-xl shadow-2xl w-80 border z-50 hidden" data-current-id="" style="left: 88.6172px; top: 461.297px;">
                <div class="p-4">
                    <div class="flex items-start justify-between mb-2">
                        <h3 class="text-xl font-bold flex-1">Perceive</h3>
                        <button onclick="event.stopPropagation(); speakWord('Perceive')" class="ml-2 p-2 rounded-lg bg-blue-50 hover:bg-blue-100 text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                            <span class="material-symbols-outlined text-lg">volume_up</span>
                        </button>
                    </div>
                    <div class="text-xs text-slate-500 mb-1">verb</div>
                    <div class="text-xs text-blue-600 font-semibold mb-3">/pÉ™rËˆsiËv/</div>
                    <p class="text-sm mb-3">To interpret or become aware of something through the senses or the mind.</p>
                    <p class="text-xs text-blue-700 font-bold">æ„ŸçŸ¥ï¼›å¯Ÿè¦ºï¼›ç†è§£</p>
                </div></div>

    <!-- Selection Popup -->
    <div id="selection-popup" class="fixed hidden bg-purple-600 text-white px-4 py-2 rounded-lg shadow-xl z-50 text-sm font-semibold cursor-pointer hover:bg-purple-700 active:scale-95 transition-all">
        <span class="material-symbols-outlined text-base" style="vertical-align: middle;">add_circle</span> åŠ å…¥ç”Ÿå­—
    </div>

    <!-- Quiz Modal -->
    <div id="quiz-modal" class="hidden fixed inset-0 z-[60] bg-slate-900/80 backdrop-blur-sm flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden">
            <div class="p-6 border-b border-gray-100 bg-gray-50">
                <div class="flex justify-between items-center mb-4">
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-blue-600">psychology</span>
                        <h3 class="text-xl font-bold text-slate-800">Knowledge Check</h3>
                    </div>
                    <button onclick="closeQuiz()" class="text-gray-400 hover:text-gray-600 hover:bg-gray-200 rounded-full p-1 transition"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div id="quiz-language-selector" class="hidden flex items-center gap-2 p-3 bg-white border-2 border-slate-200 rounded-lg">
                    <span class="text-sm font-semibold text-slate-700">Quiz Language:</span>
                    <button onclick="selectQuizLanguage('english')" class="px-4 py-2 rounded-lg text-sm font-semibold border-2 transition" id="quiz-select-en">
                        <span class="material-symbols-outlined text-sm align-middle">language</span> English
                    </button>
                    <button onclick="selectQuizLanguage('chinese')" class="px-4 py-2 rounded-lg text-sm font-semibold border-2 transition" id="quiz-select-zh">
                        <span class="material-symbols-outlined text-sm align-middle">translate</span> ä¸­æ–‡
                    </button>
                </div>
            </div>
            <div id="quiz-content" class="p-8 overflow-y-auto space-y-8 bg-white"></div>
            <div id="quiz-footer" class="p-6 border-t border-gray-100 bg-gray-50 flex justify-end"></div>
        </div>
    </div>

    <!-- Add Vocab Modal -->
    <div id="add-vocab-modal" class="modal hidden fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl w-full max-w-3xl flex flex-col h-[80vh]">
            <div class="p-5 border-b flex justify-between items-center">
                <h3 class="font-bold text-lg">æ–°å¢ç”Ÿå­—</h3>
                <button onclick="closeAddVocabModal()" class="text-gray-400 hover:text-gray-700 rounded p-1">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            
            <div class="p-4 flex-1 flex flex-col gap-3">
                <div id="add-vocab-hint" class="bg-blue-50 text-blue-800 p-3 rounded text-xs">
                    æ ¼å¼ï¼š[{ "word": "...", "def": "...", "pos": "n." }, ...]
                </div>
                <textarea id="add-vocab-input" class="flex-1 border rounded p-4 font-mono text-xs resize-none" placeholder="[{&quot;word&quot;:&quot;Example&quot;,&quot;def&quot;:&quot;ç¯„ä¾‹&quot;,&quot;pos&quot;:&quot;n.&quot;}]"></textarea>
            </div>
            
            <div class="p-4 border-t flex justify-between gap-3">
                <div></div>
                <div class="flex gap-3">
                    <button onclick="closeAddVocabModal()" class="px-4 py-2 rounded border border-slate-300 hover:bg-slate-50 font-medium">Cancel</button>
                    <button onclick="addNewVocabFromJSON()" class="bg-indigo-600 text-white px-6 py-2 rounded font-bold hover:bg-indigo-700">Add</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->

    <div id="edit-modal" class="modal hidden fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl w-full max-w-4xl flex flex-col h-[85vh]">
            <div class="p-5 border-b flex justify-between items-center">
                <h3 class="font-bold text-lg">ç·¨è¼¯é€å­—ç¨¿æ®µè½</h3>
                <button onclick="closeEditModal()" class="text-gray-400 hover:text-gray-700 rounded p-1">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            
            <div class="p-6 flex-1 flex flex-col gap-4 overflow-y-auto">
                <div class="flex-1 flex flex-col">
                    <label class="font-semibold mb-2 text-sm text-slate-700">è‹±æ–‡å…§å®¹</label>
                    <textarea id="edit-en-input" class="flex-1 border-2 border-slate-300 rounded-lg p-4 font-sans text-base resize-none focus:border-blue-500 focus:outline-none min-h-[200px]" placeholder="è¼¸å…¥è‹±æ–‡å…§å®¹..."></textarea>
                </div>
                
                <div class="flex-1 flex flex-col">
                    <label class="font-semibold mb-2 text-sm text-slate-700">ä¸­æ–‡ç¿»è­¯</label>
                    <textarea id="edit-cn-input" class="flex-1 border-2 border-slate-300 rounded-lg p-4 font-sans text-base resize-none focus:border-blue-500 focus:outline-none min-h-[200px]" placeholder="è¼¸å…¥ä¸­æ–‡ç¿»è­¯ï¼ˆå¯é¸ï¼‰..."></textarea>
                </div>
                
                <div class="flex flex-col">
                    <label class="font-semibold mb-2 text-sm text-slate-700">æ™‚é–“æ¨™è¨˜ (ç§’)</label>
                    <div class="flex items-center gap-3">
                        <input type="number" id="edit-time-input" min="0" step="1" class="w-32 px-3 py-2 border-2 border-blue-300 rounded-lg bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400" placeholder="0">
                        <span class="text-sm text-slate-600">ç§’</span>
                        <button onclick="previewEditTime()" class="px-4 py-2 rounded-lg border border-blue-300 bg-blue-50 text-blue-700 text-xs font-semibold hover:bg-blue-100 transition-colors">é è¦½æ™‚é–“</button>
                    </div>
                </div>
            </div>
            
            <div class="p-4 border-t flex justify-end gap-3">
                <button onclick="closeEditModal()" class="px-6 py-2.5 rounded-lg border border-slate-300 hover:bg-slate-50 font-medium">å–æ¶ˆ</button>
                <button onclick="saveEdit()" class="bg-blue-600 text-white px-6 py-2.5 rounded-lg font-bold hover:bg-blue-700">å„²å­˜</button>
            </div>
        </div>
    </div>

    <!-- Insert Transcript Modal -->
    <div id="insert-modal" class="modal hidden fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl w-full max-w-3xl flex flex-col h-[80vh]">
            <div class="p-5 border-b flex justify-between items-center">
                <h3 class="font-bold text-lg">å¾æ®µè½ <span id="insert-segment-index"></span> æ’å…¥é€å­—ç¨¿</h3>
                <div class="flex items-center gap-2">
                    <button id="copy-insert-prompt-btn" onclick="copyInsertPrompt()" class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 hover:border-indigo-300 text-xs font-semibold transition" title="è¤‡è£½ AI Prompt">
                        <span class="material-symbols-outlined text-sm">auto_awesome</span>
                        AI Prompt
                    </button>
                    <button onclick="closeInsertModal()" class="text-gray-400 hover:text-gray-700 rounded p-1">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
            </div>
            
            <div class="p-4 flex-1 flex flex-col gap-3">
                <div class="bg-purple-50 text-purple-800 p-3 rounded text-xs">
                    æ ¼å¼ï¼š[{ "en": "...", "cn": "...", "t": 0 }, ...]<br>
                    <strong>æ³¨æ„ï¼š</strong>æ­¤åŠŸèƒ½æœƒå¾é¸å®šçš„æ®µè½é–‹å§‹ï¼Œç”¨æ–°è³‡æ–™<strong>å–ä»£</strong>ä¹‹å¾Œæ‰€æœ‰æ®µè½ï¼Œä½†ä¿ç•™ä¹‹å‰çš„æ®µè½ã€‚
                </div>
                <textarea id="insert-input" class="flex-1 border rounded p-4 font-mono text-xs resize-none" placeholder="[{&quot;en&quot;:&quot;Hello&quot;,&quot;cn&quot;:&quot;ä½ å¥½&quot;,&quot;t&quot;:0}]"></textarea>
            </div>
            
            <div class="p-4 border-t flex justify-end gap-3">
                <button onclick="closeInsertModal()" class="px-4 py-2 rounded hover:bg-gray-100">Cancel</button>
                <button onclick="insertTranscriptFromIndex()" class="bg-purple-600 text-white px-6 py-2 rounded font-bold hover:bg-purple-700">æ’å…¥é€å­—ç¨¿</button>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="import-modal" class="modal hidden fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl w-full max-w-3xl flex flex-col h-[80vh]">
            <div class="p-5 border-b flex justify-between items-center">
                <h3 class="font-bold text-lg" id="modal-title">Import</h3>
                <div class="flex items-center gap-2">
                    <button id="copy-cefr-prompt-btn" onclick="openCEFRLevelSelector()" class="hidden inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 hover:border-rose-300 text-xs font-semibold transition" title="è¤‡è£½ CEFR é›£åº¦èª¿æ•´ Prompt">
                        <span class="material-symbols-outlined text-sm">tune</span>
                        é›£åº¦èª¿æ•´
                    </button>
                    <button id="copy-transcript-prompt-btn" onclick="copyTranscriptPromptFromClipboard()" class="hidden inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-emerald-200 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 hover:border-emerald-300 text-xs font-semibold transition" title="è¤‡è£½å‰ªè²¼ç°¿ Prompt">
                        <span class="material-symbols-outlined text-sm">content_paste</span>
                        å‰ªè²¼ç°¿ Prompt
                    </button>
                    <button id="copy-prompt-btn" onclick="copyPrompt()" class="hidden inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 hover:border-indigo-300 text-xs font-semibold transition" title="è¤‡è£½ AI Prompt">
                        <span class="material-symbols-outlined text-sm">auto_awesome</span>
                        AI Prompt
                    </button>
                    <button onclick="closeModal()" class="text-gray-400 hover:text-gray-700 rounded p-1">
                        <span class="material-symbols-outlined">close</span>
                    </button>
                </div>
            </div>
            
            <div class="p-4 flex-1 flex flex-col gap-3">
                <div id="modal-hint" class="bg-blue-50 text-blue-800 p-3 rounded text-xs"></div>
                <textarea id="import-input" class="flex-1 border rounded p-4 font-mono text-xs resize-none"></textarea>
            </div>
            
            <div class="p-4 border-t flex justify-between gap-3">
                <div class="flex gap-2">
                    <button id="clear-data-btn" class="px-4 py-2 rounded border border-red-300 bg-red-50 text-red-700 hover:bg-red-100 font-medium text-sm hidden">
                        <span class="material-symbols-outlined text-base align-middle">delete_outline</span> æ¸…é™¤æ‰€æœ‰ç´€éŒ„
                    </button>
                </div>
                <div class="flex gap-3">
                    <button onclick="closeModal()" class="px-4 py-2 rounded hover:bg-gray-100">Cancel</button>
                    <button id="import-action-btn" class="bg-blue-600 text-white px-6 py-2 rounded font-bold">Load</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global State - Load from localStorage
        let transcriptData = [{"en":"In 2015, a photo of a dress became very famous on the internet. Some people saw the dress as blue and black. Others saw it as white and gold. This simple picture shocked everyone. Why? Because it showed us a big truth: two people can look at the same reality but perceive it completely differently.","cn":"2015å¹´ï¼Œä¸€å¼µæ´‹è£çš„ç…§ç‰‡åœ¨ç¶²è·¯ä¸Šè®Šå¾—éå¸¸æœ‰åã€‚æœ‰äº›äººçœ‹åˆ°çš„æ˜¯è—é»‘è‰²ï¼Œå…¶ä»–äººçœ‹åˆ°çš„å‰‡æ˜¯ç™½é‡‘è‰²ã€‚é€™å¼µç°¡å–®çš„ç…§ç‰‡éœ‡é©šäº†æ‰€æœ‰äººã€‚ç‚ºä»€éº¼ï¼Ÿå› ç‚ºå®ƒå‘æˆ‘å€‘å±•ç¤ºäº†ä¸€å€‹é‡è¦çš„çœŸç›¸ï¼šå…©å€‹äººçœ‹è‘—åŒæ¨£çš„ç¾å¯¦ï¼Œå»å¯èƒ½æœ‰å®Œå…¨ä¸åŒçš„æ„ŸçŸ¥ã€‚","t":0},{"en":"I want to talk about two main ideas today. First, our minds are more different than we think. Second, you should work with people who think differently than you because that is how we create magic.","cn":"ä»Šå¤©æˆ‘æƒ³è«‡è«‡å…©å€‹ä¸»è¦è§€é»ã€‚é¦–å…ˆï¼Œæˆ‘å€‘çš„å¿ƒæ™ºå·®ç•°æ¯”æˆ‘å€‘æƒ³åƒçš„é‚„è¦å¤§ã€‚å…¶æ¬¡ï¼Œä½ æ‡‰è©²èˆ‡æ€è€ƒæ–¹å¼ä¸åŒçš„äººåˆä½œï¼Œå› ç‚ºé€™æ­£æ˜¯æˆ‘å€‘å‰µé€ å¥‡è¹Ÿçš„æ–¹å¼ã€‚","t":10},{"en":"I work as a writer and a game designer. A few years ago, I realized that my brain works differently from most people. Letâ€™s try a small experiment. Please close your eyes and visualize this: A rocket ship lands on an alien planet. A creature knocks on the door, and someone opens it.","cn":"æˆ‘çš„è·æ¥­æ˜¯ä½œå®¶å’ŒéŠæˆ²è¨­è¨ˆå¸«ã€‚å¹¾å¹´å‰ï¼Œæˆ‘æ„è­˜åˆ°æˆ‘çš„å¤§è…¦é‹ä½œæ–¹å¼èˆ‡å¤§å¤šæ•¸äººä¸åŒã€‚è®“æˆ‘å€‘ä¾†åšå€‹å°å¯¦é©—ã€‚è«‹é–‰ä¸Šçœ¼ç›ä¸¦æƒ³åƒé€™å€‹ç•«é¢ï¼šä¸€è‰˜ç«ç®­é™è½åœ¨å¤–æ˜Ÿçƒä¸Šã€‚ä¸€å€‹ç”Ÿç‰©æ•²äº†æ•²é–€ï¼Œç„¶å¾Œæœ‰äººæ‰“é–‹äº†é–€ã€‚","t":20},{"en":"Now, answer these questions: What color was the planet? What did the creature look like? Here is what I see when I do this exercise: Nothing.","cn":"ç¾åœ¨ï¼Œå›ç­”é€™äº›å•é¡Œï¼šé‚£å€‹æ˜Ÿçƒæ˜¯ä»€éº¼é¡è‰²çš„ï¼Ÿé‚£å€‹ç”Ÿç‰©é•·ä»€éº¼æ¨£å­ï¼Ÿç•¶æˆ‘åšé€™å€‹ç·´ç¿’æ™‚ï¼Œæˆ‘çœ‹åˆ°çš„æ˜¯ï¼šä¸€ç‰‡ç©ºç™½ï¼ˆä»€éº¼éƒ½æ²’æœ‰ï¼‰ã€‚","t":30},{"en":"I have a condition called \"aphantasia.\" This means I do not have a \"mindâ€™s eye.\" I cannot see pictures in my head. Human imagination is like a spectrum (a range). On one side, some people have \"hyperphantasia\" and can see perfect images in their minds. On the other side, about 2% to 4% of people are like me. We see nothing.","cn":"æˆ‘æœ‰ä¸€ç¨®ç¨±ç‚ºã€Œç„¡æƒ³åƒåŠ›ç—‡ã€ï¼ˆaphantasiaï¼Œæˆ–ç¨±å¿ƒç›²ç—‡ï¼‰çš„ç‹€æ³ã€‚é€™æ„å‘³è‘—æˆ‘æ²’æœ‰ã€Œå¿ƒéˆä¹‹çœ¼ã€ï¼Œæˆ‘ç„¡æ³•åœ¨è…¦æµ·ä¸­çœ‹åˆ°ç•«é¢ã€‚äººé¡çš„æƒ³åƒåŠ›å°±åƒä¸€å€‹å…‰è­œï¼ˆç¯„åœï¼‰ã€‚åœ¨ä¸€ç«¯ï¼Œæœ‰äº›äººæ“æœ‰ã€Œè¶…å¼·æƒ³åƒåŠ›ã€ï¼Œå¯ä»¥åœ¨è…¦æµ·ä¸­çœ‹åˆ°å®Œç¾çš„åœ–åƒã€‚åœ¨å¦ä¸€ç«¯ï¼Œå¤§ç´„ 2% åˆ° 4% çš„äººåƒæˆ‘ä¸€æ¨£ï¼Œæˆ‘å€‘ä»€éº¼ä¹Ÿçœ‹ä¸åˆ°ã€‚","t":40},{"en":"For a long time, I thought everyone was like me. When people said, \"I can see it in my mind,\" I thought it was just a figure of speech. When I learned about aphantasia, I was scared. I thought, \"Am I in the wrong job?\"","cn":"å¾ˆé•·ä¸€æ®µæ™‚é–“ï¼Œæˆ‘ä»¥ç‚ºæ¯å€‹äººéƒ½è·Ÿæˆ‘ä¸€æ¨£ã€‚ç•¶äººå€‘èªªã€Œæˆ‘å¯ä»¥åœ¨è…¦æµ·ä¸­çœ‹åˆ°å®ƒã€æ™‚ï¼Œæˆ‘ä»¥ç‚ºé‚£åªæ˜¯å€‹æ¯”å–»ã€‚ç•¶æˆ‘å¾—çŸ¥ç„¡æƒ³åƒåŠ›ç—‡æ™‚ï¼Œæˆ‘æ„Ÿåˆ°å¾ˆå®³æ€•ã€‚æˆ‘æƒ³ï¼šã€Œæˆ‘æ˜¯ä¸æ˜¯å…¥éŒ¯è¡Œäº†ï¼Ÿã€","t":50},{"en":"This condition changes how I process information. For example, when most people read a book, they see a movie in their heads. I cannot do that. For me, reading is a conceptual experience. I understand the ideas, but I donâ€™t see the scenes. This also affects my memory. I have a five-year-old daughter, but when I am not looking at her, I cannot see her face in my mind.","cn":"é€™å€‹ç‹€æ³æ”¹è®Šäº†æˆ‘è™•ç†è³‡è¨Šçš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œç•¶å¤§å¤šæ•¸äººé–±è®€å°èªªæ™‚ï¼Œä»–å€‘è…¦ä¸­æœƒåƒåœ¨çœ‹é›»å½±ã€‚æˆ‘ç„¡æ³•é‚£æ¨£åšã€‚å°æˆ‘ä¾†èªªï¼Œé–±è®€æ˜¯ä¸€ç¨®æ¦‚å¿µæ€§çš„é«”é©—ã€‚æˆ‘ç†è§£é€™äº›æƒ³æ³•ï¼Œä½†çœ‹ä¸åˆ°å ´æ™¯ã€‚é€™ä¹Ÿå½±éŸ¿äº†æˆ‘çš„è¨˜æ†¶ã€‚æˆ‘æœ‰å€‹äº”æ­²çš„å¥³å…’ï¼Œä½†ç•¶æˆ‘æ²’çœ‹è‘—å¥¹æ™‚ï¼Œæˆ‘ç„¡æ³•åœ¨è…¦æµ·ä¸­æµ®ç¾å¥¹çš„è‡‰é¾ã€‚","t":60},{"en":"So, how do I design games if I cannot imagine pictures? I focus on the structureâ€”the \"skeleton\"â€”rather than the \"skin.\" I think about the rules and the story first. Then, I work with amazing artists who can visualize the details.","cn":"é‚£éº¼ï¼Œå¦‚æœæˆ‘ç„¡æ³•æƒ³åƒç•«é¢ï¼Œæˆ‘è¦å¦‚ä½•è¨­è¨ˆéŠæˆ²å‘¢ï¼Ÿæˆ‘å°ˆæ³¨æ–¼çµæ§‹â€”â€”ä¹Ÿå°±æ˜¯ã€Œéª¨æ¶ã€â€”â€”è€Œä¸æ˜¯ã€Œçš®è†šã€ã€‚æˆ‘å…ˆæ§‹æ€è¦å‰‡å’Œæ•…äº‹ã€‚ç„¶å¾Œï¼Œæˆ‘èˆ‡é‚£äº›èƒ½å¤ å°‡ç´°ç¯€å…·è±¡åŒ–çš„å„ªç§€è—è¡“å®¶åˆä½œã€‚","t":70},{"en":"This experience taught me something important. Aphantasia is just one example of neurological diversity. There are many other types, like autism, ADHD, and dyslexia. Society often treats these as illnesses or problems. I think that is wrong. There is no \"normal\" brain. Being different is not bad.","cn":"é€™æ¬¡ç¶“æ­·æ•™æœƒäº†æˆ‘ä¸€ä»¶é‡è¦çš„äº‹ã€‚ç„¡æƒ³åƒåŠ›ç—‡åªæ˜¯ç¥ç¶“å¤šæ¨£æ€§çš„ä¸€å€‹ä¾‹å­ã€‚é‚„æœ‰è¨±å¤šå…¶ä»–é¡å‹ï¼Œå¦‚è‡ªé–‰ç—‡ã€ADHDï¼ˆæ³¨æ„åŠ›ä¸è¶³éå‹•ç—‡ï¼‰å’Œé–±è®€éšœç¤™ã€‚ç¤¾æœƒé€šå¸¸å°‡é€™äº›è¦–ç‚ºç–¾ç—…æˆ–å•é¡Œã€‚æˆ‘èªç‚ºé€™æ˜¯éŒ¯çš„ã€‚ä¸¦æ²’æœ‰æ‰€è¬‚ã€Œæ­£å¸¸ã€çš„å¤§è…¦ã€‚èˆ‡çœ¾ä¸åŒä¸¦ä¸æ˜¯å£äº‹ã€‚","t":80},{"en":"In fact, research shows that teams with different types of people produce better results. Companies are starting to hire people who think differently, and they are seeing great success. In my career, I work with artists who have powerful visual imaginations. Because our minds are different, we make wonderful things together.","cn":"äº‹å¯¦ä¸Šï¼Œç ”ç©¶é¡¯ç¤ºç”±ä¸åŒé¡å‹çš„äººçµ„æˆçš„åœ˜éšŠèƒ½ç”¢ç”Ÿæ›´å¥½çš„çµæœã€‚ä¼æ¥­é–‹å§‹åƒ±ç”¨æ€è€ƒæ–¹å¼ä¸åŒçš„äººï¼Œä¸¦ä¸”çœ‹è¦‹äº†å·¨å¤§çš„æˆåŠŸã€‚åœ¨æˆ‘çš„è·æ¥­ç”Ÿæ¶¯ä¸­ï¼Œæˆ‘èˆ‡æ“æœ‰å¼·å¤§è¦–è¦ºæƒ³åƒåŠ›çš„è—è¡“å®¶åˆä½œã€‚æ­£å› ç‚ºæˆ‘å€‘çš„å¿ƒæ™ºä¸åŒï¼Œæˆ‘å€‘ä¸€èµ·å‰µé€ äº†ç¾å¦™çš„äº‹ç‰©ã€‚","t":90},{"en":"So, am I in the wrong field? No. I realized that my different mind is not a weakness. It is a gift. We should all look for minds that are different from ours. When we combine our different ways of thinking, we can do incredible things.","cn":"æ‰€ä»¥ï¼Œæˆ‘å…¥éŒ¯è¡Œäº†å—ï¼Ÿä¸ã€‚æˆ‘æ„è­˜åˆ°æˆ‘ç¨ç‰¹çš„å¿ƒæ™ºä¸æ˜¯å¼±é»ï¼Œè€Œæ˜¯ç¦®ç‰©ã€‚æˆ‘å€‘éƒ½æ‡‰è©²å°‹æ‰¾èˆ‡æˆ‘å€‘ä¸åŒçš„å¿ƒæ™ºã€‚ç•¶æˆ‘å€‘çµåˆå½¼æ­¤ä¸åŒçš„æ€è€ƒæ–¹å¼æ™‚ï¼Œæˆ‘å€‘å°±èƒ½æˆå°±ä¸å¯æ€è­°çš„äº‹ã€‚","t":100}];
        let vocabData = [{"id":"perceive","word":"Perceive","ipa":"/pÉ™rËˆsiËv/","pos":"verb","def":"To interpret or become aware of something through the senses or the mind.","cn":"æ„ŸçŸ¥ï¼›å¯Ÿè¦ºï¼›ç†è§£"},{"id":"visualize","word":"Visualize","ipa":"/ËˆvÉªÊ’.u.É™.laÉªz/","pos":"verb","def":"To form a mental image of something; to imagine.","cn":"æƒ³åƒï¼›åœ¨è…¦æµ·ä¸­é¡¯ç¾åœ–åƒ"},{"id":"aphantasia","word":"Aphantasia","ipa":"/ËŒeÉª.fÃ¦nËˆteÉª.Ê’É™/","pos":"noun","def":"A condition where a person cannot voluntarily create mental images in their mind.","cn":"ç„¡æƒ³åƒåŠ›ç—‡ (åˆç¨±å¿ƒç›²ç—‡)"},{"id":"spectrum","word":"Spectrum","ipa":"/Ëˆspek.trÉ™m/","pos":"noun","def":"A range of different positions, opinions, or values between two extreme points.","cn":"å…‰è­œï¼›ç¯„åœï¼›å¹…åº¦"},{"id":"hyperphantasia","word":"Hyperphantasia","ipa":"/ËŒhaÉª.pÉ™r.fÃ¦nËˆteÉª.Ê’É™/","pos":"noun","def":"The condition of having extremely vivid mental imagery.","cn":"è¶…å¼·æƒ³åƒåŠ› (å¿ƒåƒæ¥µåº¦æ¸…æ™°)"},{"id":"conceptual","word":"Conceptual","ipa":"/kÉ™nËˆsep.tÊƒu.É™l/","pos":"adjective","def":"Based on ideas or principles rather than concrete examples or physical reality.","cn":"æ¦‚å¿µä¸Šçš„ï¼›è§€å¿µçš„"},{"id":"neurological","word":"Neurological","ipa":"/ËŒnÊŠr.É™ËˆlÉ‘Ë.dÊ’Éª.kÉ™l/","pos":"adjective","def":"Relating to the anatomy, functions, and organic disorders of nerves and the nervous system.","cn":"ç¥ç¶“å­¸çš„ï¼›ç¥ç¶“ç³»çµ±çš„"},{"id":"dyslexia","word":"Dyslexia","ipa":"/dÉªsËˆlek.si.É™/","pos":"noun","def":"A learning disorder that affects a person's ability to read, write, and spell.","cn":"é–±è®€éšœç¤™"}];
        let quizData = {"english":[{"q":"According to the text, what is \"aphantasia\"?","options":["The ability to see perfect images in the mind.","The inability to voluntarily visualize mental images.","A condition where one cannot recognize faces.","A type of color blindness affecting how one sees clothing."],"correct":1},{"q":"How does the author approach game design without a \"mind's eye\"?","options":["By focusing on the visual details first.","By hiring someone else to do all the work.","By focusing on the structure, rules, and story.","By only writing books instead of games."],"correct":2},{"q":"Why did the author initially feel scared upon learning about their condition?","options":["They thought they were losing their memory.","They feared they were in the wrong career field.","They were afraid of doctors.","They thought they would eventually go blind."],"correct":1},{"q":"What does the author imply by comparing human imagination to a \"spectrum\"?","options":["Everyone visualizes exactly the same way.","Most people fall into the category of hyperphantasia.","There is a wide range of visualization abilities among people.","Imagination is strictly related to seeing colors like a rainbow."],"correct":2},{"q":"What is the main purpose of mentioning the \"dress\" photo in the introduction?","options":["To teach the audience about fashion trends.","To prove that some people have better eyesight than others.","To show that people can perceive the same reality differently.","To explain why the photo went viral on the internet."],"correct":2},{"q":"What is the author's core message regarding neurological diversity (like autism, ADHD, etc.)?","options":["These are illnesses that need to be fixed immediately.","Companies should avoid hiring people who think differently.","There is only one \"normal\" way for a brain to function.","Different ways of thinking are gifts that create better outcomes."],"correct":3}],"chinese":[{"q":"æ ¹æ“šæ–‡ç« ï¼Œã€Œç„¡æƒ³åƒåŠ›ç—‡ã€(aphantasia) æ˜¯ä»€éº¼ï¼Ÿ","options":["èƒ½åœ¨è…¦æµ·ä¸­çœ‹è¦‹å®Œç¾å½±åƒçš„èƒ½åŠ›ã€‚","ç„¡æ³•åœ¨è…¦æµ·ä¸­è‡ªä¸»ç”¢ç”Ÿè¦–è¦ºå½±åƒã€‚","ä¸€ç¨®ç„¡æ³•è¾¨è­˜äººè‡‰çš„ç‹€æ³ã€‚","ä¸€ç¨®å½±éŸ¿äººå€‘è§€çœ‹è¡£ç‰©çš„è‰²ç›²ã€‚",""],"correct":1},{"q":"ä½œè€…å¦‚ä½•åœ¨æ²’æœ‰ã€Œå¿ƒéˆä¹‹çœ¼ã€çš„æƒ…æ³ä¸‹é€²è¡ŒéŠæˆ²è¨­è¨ˆï¼Ÿ","options":["å„ªå…ˆå°ˆæ³¨æ–¼è¦–è¦ºç´°ç¯€ã€‚","è˜è«‹å…¶ä»–äººä¾†åšæ‰€æœ‰çš„å·¥ä½œã€‚","å°ˆæ³¨æ–¼çµæ§‹ã€è¦å‰‡å’Œæ•…äº‹ã€‚","åªå¯«æ›¸è€Œä¸è¨­è¨ˆéŠæˆ²ã€‚"],"correct":2},{"q":"ç‚ºä»€éº¼ä½œè€…åœ¨å¾—çŸ¥è‡ªå·±çš„ç‹€æ³æ™‚æœ€åˆæ„Ÿåˆ°å®³æ€•ï¼Ÿ","options":["ä»–å€‘ä»¥ç‚ºè‡ªå·±æ­£åœ¨å¤±å»è¨˜æ†¶ã€‚","ä»–å€‘æ“”å¿ƒè‡ªå·±é¸éŒ¯äº†è·æ¥­é ˜åŸŸã€‚","ä»–å€‘å®³æ€•çœ‹é†«ç”Ÿã€‚","ä»–å€‘ä»¥ç‚ºè‡ªå·±æœ€çµ‚æœƒå¤±æ˜ã€‚"],"correct":1},{"q":"ä½œè€…å°‡äººé¡çš„æƒ³åƒåŠ›æ¯”å–»ç‚ºã€Œå…‰è­œã€ï¼Œæš—ç¤ºäº†ä»€éº¼ï¼Ÿ","options":["æ¯å€‹äººçš„æƒ³åƒæ–¹å¼éƒ½å®Œå…¨ç›¸åŒã€‚","å¤§å¤šæ•¸äººéƒ½å±¬æ–¼æ“æœ‰è¶…å¼·æƒ³åƒåŠ›çš„é¡åˆ¥ã€‚","äººå€‘çš„è¦–è¦ºåŒ–èƒ½åŠ›å­˜åœ¨å¾ˆå¤§å·®ç•°ã€‚","æƒ³åƒåŠ›åš´æ ¼ä¾†èªªèˆ‡çœ‹è¦‹åƒå½©è™¹ä¸€æ¨£çš„é¡è‰²æœ‰é—œã€‚"],"correct":2},{"q":"å¼•è¨€ä¸­æåˆ°ã€Œæ´‹è£ã€ç…§ç‰‡çš„ä¸»è¦ç›®çš„æ˜¯ä»€éº¼ï¼Ÿ","options":["ä»¥æ­¤æ•™å°è§€çœ¾æœ‰é—œæ™‚å°šè¶¨å‹¢ã€‚","è­‰æ˜æœ‰äº›äººçš„è¦–åŠ›æ¯”åˆ¥äººå¥½ã€‚","é¡¯ç¤ºäººå€‘å°åŒä¸€ç¾å¯¦å¯èƒ½æœ‰ä¸åŒçš„æ„ŸçŸ¥ã€‚","è§£é‡‹ç‚ºä»€éº¼é€™å¼µç…§ç‰‡åœ¨ç¶²è·¯ä¸Šçˆ†ç´…ã€‚"],"correct":2},{"q":"é—œæ–¼ç¥ç¶“å¤šæ¨£æ€§ï¼ˆå¦‚è‡ªé–‰ç—‡ã€ADHDç­‰ï¼‰ï¼Œä½œè€…çš„æ ¸å¿ƒè¨Šæ¯æ˜¯ä»€éº¼ï¼Ÿ","options":["é€™äº›æ˜¯éœ€è¦ç«‹å³æ²»ç™‚çš„ç–¾ç—…ã€‚","å…¬å¸æ‡‰é¿å…åƒ±ç”¨æ€è€ƒæ–¹å¼ä¸åŒçš„äººã€‚","å¤§è…¦åªæœ‰ä¸€ç¨®ã€Œæ­£å¸¸ã€çš„é‹ä½œæ–¹å¼ã€‚","ä¸åŒçš„æ€è€ƒæ–¹å¼æ˜¯å¤©è³¦ï¼Œèƒ½å‰µé€ æ›´å¥½çš„æˆæœã€‚"],"correct":3}]};
        let quizLanguage = 'english'; // 'english' or 'chinese'
        let videoId = localStorage.getItem('videoId') || '';
        let selectedWords = [];
        let cefrLevel = localStorage.getItem('cefrLevel') || ''; // Store selected CEFR level
        let translationsVisible = false;
        let player;
        let playerReady = false;
        
        // TTS (Text-to-Speech) State
        let currentSpeakingSegment = null;
        let isSpeechPaused = false;

        // Sticky video functionality
        const videoContainer = document.getElementById('video-container');
        const videoSection = document.getElementById('video-section');
        const videoPlaceholder = document.getElementById('video-placeholder');
        const closeBtn = document.getElementById('close-sticky-video');
        const floatingCloseBtn = document.getElementById('floating-close-btn');
        let isSticky = false;
        let manuallyHidden = false;
        let initialTop = 0;

        // Calculate initial position once
        if (videoSection) {
            setTimeout(() => {
                initialTop = videoSection.getBoundingClientRect().top + window.scrollY;
            }, 100);
        }

        function updateStickyVideo() {
            if (!videoSection || manuallyHidden) return;
            
            const shouldBeSticky = window.scrollY > initialTop + 100;
            
            if (shouldBeSticky && !isSticky) {
                videoContainer.classList.add('sticky-video');
                videoPlaceholder.classList.remove('hidden');
                closeBtn.classList.remove('hidden');
                floatingCloseBtn.classList.remove('hidden');
                isSticky = true;
            } else if (!shouldBeSticky && isSticky) {
                videoContainer.classList.remove('sticky-video');
                videoPlaceholder.classList.add('hidden');
                closeBtn.classList.add('hidden');
                floatingCloseBtn.classList.add('hidden');
                isSticky = false;
            }
        }

        function closeStickyVideo() {
            videoContainer.classList.remove('sticky-video');
            videoPlaceholder.classList.add('hidden');
            closeBtn.classList.add('hidden');
            floatingCloseBtn.classList.add('hidden');
            isSticky = false;
            manuallyHidden = true;
        }

        function manualToggleSticky() {
            if (isSticky) {
                // å¦‚æœå·²ç¶“æ˜¯æµ®å‹•ç‹€æ…‹ï¼Œé—œé–‰å®ƒ
                closeStickyVideo();
            } else {
                // é–‹å•Ÿæµ®å‹•æ¨¡å¼
                videoContainer.classList.add('sticky-video');
                videoPlaceholder.classList.remove('hidden');
                closeBtn.classList.remove('hidden');
                floatingCloseBtn.classList.remove('hidden');
                isSticky = true;
                manuallyHidden = false;
            }
        }

        closeBtn.addEventListener('click', closeStickyVideo);
        floatingCloseBtn.addEventListener('click', closeStickyVideo);

        window.addEventListener('scroll', updateStickyVideo);
        window.addEventListener('resize', () => {
            if (videoSection && !manuallyHidden) {
                initialTop = videoSection.getBoundingClientRect().top + window.scrollY;
                updateStickyVideo();
            }
        });

        let youtubeAPIReady = false;
        let currentFontSize = 18; // base font size in px
        let currentPlaybackSpeed = 1.0;

        const modal = document.getElementById('import-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalHint = document.getElementById('modal-hint');
        const inputArea = document.getElementById('import-input');
        const actionBtn = document.getElementById('import-action-btn');
        const floatingCard = document.getElementById('floating-card');
        const transcriptPromptBtn = document.getElementById('copy-transcript-prompt-btn');

        // Modal Functions
        function openModal(mode) {
            modal.classList.remove('hidden');
            inputArea.value = '';
            inputArea.focus();
            const clearBtn = document.getElementById('clear-data-btn');
            const copyBtn = document.getElementById('copy-prompt-btn');
            const cefrBtn = document.getElementById('copy-cefr-prompt-btn');
            window.currentModalMode = mode;
            
            if (mode === 'video') {
                modalTitle.innerText = "è¨­å®š YouTube å½±ç‰‡";
                modalHint.innerText = 'è²¼ä¸Š YouTube ç¶²å€æˆ–å½±ç‰‡ ID';
                inputArea.placeholder = 'https://www.youtube.com/watch?v=...';
                actionBtn.onclick = parseVideoUrl;
                clearBtn.classList.add('hidden');
                copyBtn.classList.add('hidden');
                transcriptPromptBtn.classList.add('hidden');
                cefrBtn.classList.add('hidden');
            } else if (mode === 'transcript') {
                modalTitle.innerText = "åŒ¯å…¥é€å­—ç¨¿";
                modalHint.innerText = 'æ ¼å¼ï¼š[{ "en": "...", "cn": "...", "t": 0 }, ...]';
                inputArea.placeholder = '[{"en":"Hello","cn":"ä½ å¥½","t":0}]';
                actionBtn.onclick = parseTranscript;
                clearBtn.classList.remove('hidden');
                copyBtn.classList.remove('hidden');
                transcriptPromptBtn.classList.remove('hidden');
                cefrBtn.classList.remove('hidden');
                clearBtn.onclick = () => {
                    if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰é€å­—ç¨¿ç´€éŒ„å—ï¼Ÿ')) {
                        clearTranscriptData();
                    }
                };
            } else if (mode === 'vocab') {
                modalTitle.innerText = "åŒ¯å…¥å–®å­—";
                modalHint.innerText = 'æ ¼å¼ï¼š[{ "word": "...", "def": "...", "pos": "n." }, ...]';
                inputArea.placeholder = '[{"word":"Example","def":"ç¯„ä¾‹"}]';
                actionBtn.onclick = parseVocab;
                clearBtn.classList.remove('hidden');
                copyBtn.classList.remove('hidden');
                transcriptPromptBtn.classList.add('hidden');
                cefrBtn.classList.add('hidden');
                clearBtn.onclick = () => {
                    if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰å–®å­—ç´€éŒ„å—ï¼Ÿ')) {
                        clearVocabData();
                    }
                };
            } else {
                modalTitle.innerText = "åŒ¯å…¥ Quizï¼ˆé›™èªæ ¼å¼ï¼‰";
                modalHint.innerText = 'æ ¼å¼ï¼š{ "english": [{"q":"...", "options":[...], "correct":0}], "chinese": [{"q":"...", "options":[...], "correct":0}] }';
                inputArea.placeholder = '{"english":[{"q":"Question?","options":["A","B","C","D"],"correct":0}],"chinese":[{"q":"é¡Œç›®?","options":["A","B","C","D"],"correct":0}]}';
                actionBtn.onclick = parseQuiz;
                clearBtn.classList.remove('hidden');
                copyBtn.classList.remove('hidden');
                transcriptPromptBtn.classList.add('hidden');
                cefrBtn.classList.add('hidden');
                clearBtn.onclick = () => {
                    if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰ Quiz é¡Œåº«å—ï¼Ÿ')) {
                        clearQuizData();
                    }
                };
            }
        }

        function closeModal() {
            modal.classList.add('hidden');
        }

        function selectQuizLanguage(lang) {
            quizLanguage = lang;
            updateQuizLanguageSelector();
            renderQuizContent(); // é‡æ–°æ¸²æŸ“é¡Œç›®
        }

        function updateQuizLanguageSelector() {
            const btnEn = document.getElementById('quiz-select-en');
            const btnZh = document.getElementById('quiz-select-zh');
            
            if (!btnEn || !btnZh) return;
            
            if (quizLanguage === 'english') {
                btnEn.classList.add('bg-blue-600', 'text-white', 'border-blue-600');
                btnEn.classList.remove('bg-white', 'text-slate-700', 'border-slate-300');
                btnZh.classList.remove('bg-blue-600', 'text-white', 'border-blue-600');
                btnZh.classList.add('bg-white', 'text-slate-700', 'border-slate-300');
            } else {
                btnZh.classList.add('bg-blue-600', 'text-white', 'border-blue-600');
                btnZh.classList.remove('bg-white', 'text-slate-700', 'border-slate-300');
                btnEn.classList.remove('bg-blue-600', 'text-white', 'border-blue-600');
                btnEn.classList.add('bg-white', 'text-slate-700', 'border-slate-300');
            }
        }


        function generateTranscriptPrompt() {
            let prompt = '';
            
            // Add video URL if available
            if (videoId && videoId.length === 11) {
                prompt += `https://www.youtube.com/watch?v=${videoId}\n\n`;
            } else {
                prompt += 'ğŸ”»\n\n';
            }
            
            prompt += `å°‡ä»¥ä¸Šå½±ç‰‡çš„æ¼”è¬›å…§å®¹ï¼Œæ•´ç†æˆè‹±æ–‡å’Œä¸­æ–‡éš¨æ®µè½å°ç…§çš„é€å­—ç¨¿ï¼Œä¸¦ä»¥ä»¥ä¸‹æ ¼å¼åš´æ ¼ä¾ç…§ JSON Array æ ¼å¼è¼¸å‡ºçµæœï¼šï¼š
{
    en: "When I found out my grandmother, my last living grandparent, was dying, my first thought was, \"I need to draw her hands.\" I'm a visual artist, a cartoonist for The New Yorker, and comics writer, so drawing is how I understand much of the world.",
    cn: "ç•¶æˆ‘å¾—çŸ¥æˆ‘çš„ç¥–æ¯â€”â€”æˆ‘æœ€å¾Œä¸€ä½åœ¨ä¸–çš„ç¥–çˆ¶æ¯â€”â€”å³å°‡é›¢ä¸–æ™‚ï¼Œæˆ‘çš„ç¬¬ä¸€å€‹å¿µé ­æ˜¯ï¼šã€Œæˆ‘éœ€è¦ç•«ä¸‹å¥¹çš„æ‰‹ã€‚ã€æˆ‘æ˜¯ä¸€ä½è¦–è¦ºè—è¡“å®¶ï¼Œä¹Ÿæ˜¯ã€Šç´ç´„å®¢ã€‹çš„æ¼«ç•«å®¶å’Œæ¼«ç•«ä½œè€…ï¼Œæ‰€ä»¥ç¹ªç•«æ˜¯æˆ‘ç†è§£é€™å€‹ä¸–ç•Œçš„ä¸»è¦æ–¹å¼ã€‚"
},
{
    en: "For a long time, my cartoons had been impersonal. Commentary on the world around me, sure, but not really about me. The closest my personal life got to influencing my cartoons were cartoons I lifted from things my friends and family had said around me. It was only after my daughter Ellika was born that my personal life began to creep into my cartoons more.",
    cn: "å¾ˆé•·ä¸€æ®µæ™‚é–“ä»¥ä¾†ï¼Œæˆ‘çš„æ¼«ç•«éƒ½æ˜¯éå€‹äººåŒ–çš„ã€‚å®ƒå€‘æ˜¯å°å‘¨é­ä¸–ç•Œçš„è©•è«–ï¼Œæ²’éŒ¯ï¼Œä½†ä¸¦ä¸çœŸæ­£é—œæ–¼æˆ‘è‡ªå·±ã€‚æˆ‘çš„å€‹äººç”Ÿæ´»å°æ¼«ç•«æœ€æ¥è¿‘çš„å½±éŸ¿ï¼Œé ‚å¤šå°±æ˜¯å¾æœ‹å‹å’Œå®¶äººçš„è«‡è©±ä¸­å–æã€‚ç›´åˆ°æˆ‘å¥³å…’åŸƒè‰å¡ (Ellika) å‡ºç”Ÿå¾Œï¼Œæˆ‘çš„å€‹äººç”Ÿæ´»æ‰é–‹å§‹æ›´å¤šåœ°æ»²é€é€²æˆ‘çš„æ¼«ç•«ä¸­ã€‚"
}`;
            
            return prompt;
        }

        function generateQuizPrompt() {
            let prompt = '# Role: ä½ æ˜¯ä¸€ä½è³‡æ·±çš„è‹±èªæ•™å­¸è©•é‡å°ˆå®¶ï¼Œå°ˆç²¾æ–¼ CEFR ç­‰ç´šåˆ†æèˆ‡é–±è®€ç†è§£è¨ºæ–·ã€‚\n\n';
            prompt += '# Task: è«‹é‡å°æˆ‘æä¾›çš„è‹±æ–‡æ–‡ç« ï¼Œè¨­è¨ˆä¸€ä»½ç”¨æ–¼ã€Œè©•ä¼°å­¸ç”Ÿé–±è®€ç¨‹åº¦ã€çš„é¡Œçµ„ã€‚\n\n';
            prompt += '# Requirements:\n\n';
            prompt += '1. **æ–‡ç« ç¨‹åº¦è¨ºæ–·**ï¼šå…ˆç°¡è¿°é€™ç¯‡æ–‡ç« åœ¨ CEFR æ¨™æº–ä¸‹å±¬æ–¼å“ªå€‹ç­‰ç´šï¼Œä¸¦åˆ—å‡º 5-10 å€‹å½±éŸ¿é›£åº¦çš„é—œéµè©å½™ã€‚\n\n';
            prompt += '2. **é¡Œçµ„è¨­è¨ˆ**ï¼šè«‹æ ¹æ“šã€Œé–±è®€ç†è§£ä¸‰å±¤æ¬¡ã€è¨­è¨ˆ 6 é“é¸æ“‡é¡Œï¼š\n';
            prompt += '   - Level 1: å­—é¢ç†è§£é¡Œ (Literal) x 2 (ç­”æ¡ˆç›´æ¥åœ¨æ–‡ä¸­)\n';
            prompt += '   - Level 2: æ¨è«–ç†è§£é¡Œ (Inferential) x 2 (éœ€è¦æ•´åˆä¸Šä¸‹æ–‡æˆ–çŒœæ¸¬èªæ°£)\n';
            prompt += '   - Level 3: æ‰¹åˆ¤/æ•´åˆé¡Œ (Evaluative) x 2 (éœ€è¦ç†è§£ä½œè€…æ ¸å¿ƒæ„åœ–æˆ–å»¶ä¼¸æ€è€ƒ)\n\n';
            prompt += '3. **è®€è€…ç¨‹åº¦è¨ºæ–·æŒ‡å—**ï¼šé€™éƒ¨åˆ†æœ€é‡è¦ã€‚è«‹æä¾›ä¸€å€‹å°ç…§è¡¨ï¼Œèªªæ˜å­¸ç”Ÿç­”å°é¡Œæ•¸æ‰€ä»£è¡¨çš„ CEFR é–±è®€èƒ½åŠ›è½é»ï¼Œä»¥åŠå¾ŒçºŒçš„å­¸ç¿’å»ºè­°ã€‚\n\n';
            prompt += '# Output Format:\n\n';
            prompt += '---\n\n';
            prompt += '## ä¸€ã€ æ–‡ç« é›£åº¦åˆ†æ (CEFR Level)\n\n';
            prompt += '## äºŒã€ é–±è®€è©•ä¼°é¡Œçµ„ (é™„é¸é …èˆ‡æ­£ç¢ºç­”æ¡ˆ)\n\n';
            prompt += '## ä¸‰ã€ å­¸ç”Ÿç¨‹åº¦è¨ºæ–·æŒ‡å— (Diagnostic Guide)\n\n';
            prompt += '- ç­”å° 0-2 é¡Œï¼šç¨‹åº¦è½é»èˆ‡å»ºè­°\n';
            prompt += '- ç­”å° 3-4 é¡Œï¼šç¨‹åº¦è½é»èˆ‡å»ºè­°\n';
            prompt += '- ç­”å° 5-6 é¡Œï¼šç¨‹åº¦è½é»èˆ‡å»ºè­°\n\n';
            prompt += '---\n\n';
            prompt += 'Please output a JSON object with TWO keys: "english" and "chinese", each containing a JSON Array of questions.\n';
            prompt += 'Format specifications:\n\n';
            prompt += '{\n';
            prompt += '  "english": [\n';
            prompt += '    { "q": "Question in English", "options": ["Option A", "Option B", "Option C", "Option D"], "correct": 0 },\n';
            prompt += '    ...\n';
            prompt += '  ],\n';
            prompt += '  "chinese": [\n';
            prompt += '    { "q": "é¡Œç›®ä¸­æ–‡ç¿»è­¯", "options": ["é¸é …A", "é¸é …B", "é¸é …C", "é¸é …D"], "correct": 0 },\n';
            prompt += '    ...\n';
            prompt += '  ]\n';
            prompt += '}\n\n';
            prompt += 'Requirements:\n';
            prompt += '- Both English and Chinese versions must have the SAME questions with the SAME correct answers (index).\n';
            prompt += '- English: questions and options in English\n';
            prompt += '- Chinese: complete translation of questions and options to Traditional Chinese\n';
            prompt += '- Output ONLY the JSON object, no explanations or extra text.\n';
            prompt += '- Questions should cover content comprehension, key details, main idea, and inference.\n';
            prompt += '- Avoid duplicate questions or overly similar options.\n';
            prompt += '- Content must be faithful to the transcript; do not add information not present in it.\n\n';
            prompt += 'English transcript:';
            
            if (transcriptData.length > 0) {
                const englishText = transcriptData.map(seg => seg.en).join(' ');
                prompt += englishText;
            } else {
                prompt += 'ğŸ”»';
            }
            
            return prompt;
        }

        function generateVocabPrompt() {
            let prompt = 'ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„è‹±èªæ•™å­¸å°ˆå®¶èˆ‡ç¨‹å¼é–‹ç™¼è¼”åŠ©è€…ã€‚è«‹åˆ†ææˆ‘æä¾›çš„æ–‡ç« ï¼Œä¸¦å¾ä¸­æŒ‘é¸å‡ºå°è®€è€…å¯èƒ½è¼ƒé›£ã€å†·åƒ»æˆ–å…·å‚™å­¸ç¿’åƒ¹å€¼çš„ç”Ÿå­—ï¼ˆå»ºè­°é›£åº¦ B2-C2 æˆ–ç‰¹å®šé ˜åŸŸè¡“èªï¼‰ã€‚\n\n';
            prompt += 'è«‹åš´æ ¼ä¾ç…§ä»¥ä¸‹ JSON Array æ ¼å¼è¼¸å‡ºçµæœï¼š\n\n';
            prompt += '1.  **id**: å–®å­—çš„å…¨å°å¯«å½¢å¼ã€‚\n';
            prompt += '2.  **word**: å–®å­—çš„é¦–å­—æ¯å¤§å¯«ã€‚\n';
            prompt += '3.  **ipa**: è©²å–®å­—çš„ IPA éŸ³æ¨™ã€‚\n';
            prompt += '4.  **pos**: è©æ€§ (å¦‚ noun, verb, adjective)ã€‚\n';
            prompt += '5.  **def**: ç°¡æ½”çš„è‹±æ–‡å®šç¾©ã€‚\n';
            prompt += '6.  **cn**: ç¹é«”ä¸­æ–‡è§£é‡‹ (è‹¥æœ‰ç‰¹å®šèªå¢ƒè«‹ä¸€ä½µæ¨™è¨»)ã€‚\n';
            prompt += 'ç¯„ä¾‹æ ¼å¼ï¼š\n';
            prompt += '[\n    {\n        "id": "pareidolia",\n        "word": "Pareidolia",\n        "ipa": "/ËŒpÃ¦r.ÉªËˆdoÊŠ.li.É™/",\n        "pos": "noun",\n        "def": "The psychological phenomenon of seeing recognizable shapes, especially faces, in random or vague stimuli.",\n        "cn": "å¹»æƒ³æ€§éŒ¯è¦º (å°¤æŒ‡å°‡æ¨¡ç³Šåœ–åƒçœ‹ä½œäººè‡‰)",\n     }\n]\n\n';
            prompt += 'æ–‡ç« å…§å®¹å¦‚ä¸‹ï¼š\n';
            
            // Add English transcript if available
            if (transcriptData.length > 0) {
                const englishText = transcriptData.map(seg => seg.en).join(' ');
                prompt += englishText + '\n\n';
            } else {
                prompt += 'ğŸ”»\n\n';
            }
            
            return prompt;
        }

        function generateCEFRAdaptationPrompt(targetLevel, options = {}) {
            let prompt = '# Role: ä½ æ˜¯ä¸€ä½è³‡æ·±çš„è‹±èªæ•™æç·¨å¯«å°ˆå®¶ï¼Œæ“…é•·æ ¹æ“š CEFR æ¨™æº–èª¿æ•´æ–‡æœ¬é›£åº¦ã€‚\n\n';
            prompt += '# Task: è«‹å°‡æˆ‘æä¾›çš„åŸå§‹é€å­—ç¨¿ï¼Œæ”¹å¯«ç‚ºç¬¦åˆ [' + targetLevel + '] ç¨‹åº¦çš„è‹±æ–‡æ–‡ç« ã€‚\n\n';
            prompt += '# Requirements by CEFR Level:\n';
            prompt += '- è‹¥ç›®æ¨™ç‚º **A2/B1**ï¼šä½¿ç”¨å¸¸ç”¨å–®å­—ï¼ˆæ ¸å¿ƒ 2000-3000 å­—ï¼‰ï¼Œå¥å­çµæ§‹ä»¥å–®å¥ç‚ºä¸»ï¼Œé¿å…è¤‡é›œçš„å­å¥ã€‚\n';
            prompt += '- è‹¥ç›®æ¨™ç‚º **B2**ï¼šå¯ä»¥ä½¿ç”¨è¼ƒå…·é«”çš„æè¿°æ€§å‹•è©ï¼Œå…è¨±å‡ºç¾è¤‡åˆå¥ï¼Œä½†æ‡‰ä¿æŒé‚è¼¯çµæ§‹æ¸…æ™°ã€‚\n';
            prompt += '- è‹¥ç›®æ¨™ç‚º **C1**ï¼šä¿æŒåŸå§‹æ–‡ç« çš„ç²¾ç¢ºæ€§èˆ‡ä¿®é£¾èªï¼Œå¼·åŒ–å­¸è¡“æˆ–æ–‡å­¸æ€§çš„è½‰æŠ˜è©ã€‚\n\n';
            prompt += '# Guidelines:\n';
            prompt += '1. **çµæ§‹å„ªåŒ–**ï¼šå°‡åŸæœ¬é›œäº‚çš„å£èªé€å­—ç¨¿æ•´ç†æˆé‚è¼¯é€šé †çš„æ®µè½ã€‚\n';
            prompt += '2. **èªæ°£ä¿ç•™**ï¼šä¿ç•™åŸä½œè€…çš„æ ¸å¿ƒè§€é»ã€æ•…äº‹èˆ‡æƒ…æ„Ÿè‰²å½©ï¼Œä¸è¦åˆªé™¤é‡è¦çš„ä¾‹å­ã€‚\n';
            prompt += '3. **è©å½™èª¿æ•´**ï¼š[é‡å°ç›®æ¨™ç¨‹åº¦ï¼Œæ›¿æ›æ‰éæ–¼è‰±æ¾€æˆ–éæ–¼ç°¡å–®çš„è©å½™]ã€‚\n';
            
            // Add optional guidelines
            if (options.keepNarrative) {
                prompt += '4. **ä¿æŒæ•˜äº‹çµæ§‹**ï¼šè«‹ä¿æŒæ•˜äº‹çµæ§‹ï¼Œåƒ…ç°¡åŒ–å–®å­—èˆ‡æ–‡æ³•ã€‚\n';
            }
            if (options.keepCulturalRef) {
                prompt += '5. **ä¿ç•™æ–‡åŒ–å…¸æ•…**ï¼šè«‹ä¿ç•™æ–‡ç« ä¸­çš„æ–‡åŒ–å…¸æ•…ï¼Œä½†è«‹ç”¨ç°¡å–®çš„è‹±æ–‡å¥å­è£œå……è§£é‡‹è©²å…¸æ•…çš„æ„æ€ã€‚\n';
            }
            
            prompt += '6. **è¼¸å‡ºæ ¼å¼**ï¼š\n';
            prompt += '   - æ¨™é¡Œï¼š[ç‚ºæ”¹å¯«å¾Œçš„æ–‡ç« èµ·ä¸€å€‹æ¨™é¡Œ]\n';
            prompt += '   - æœ¬æ–‡ï¼š[æ”¹å¯«å¾Œçš„æ–‡ç« å…§å®¹]\n';
            prompt += '   - é—œéµå–®å­—è¡¨ï¼š[åˆ—å‡º 5 å€‹ç¬¦åˆè©²ç¨‹åº¦ã€ä¸”å°ç†è§£æœ¬æ–‡è‡³é—œé‡è¦çš„å–®å­—èˆ‡ä¸­è§£]\n\n';
            prompt += '# Target Level: ' + targetLevel + '\n\n';
            prompt += '# Original Transcript (åŸå§‹é€å­—ç¨¿):\n';
            
            if (transcriptData.length > 0) {
                const englishText = transcriptData.map(seg => seg.en).join(' ');
                prompt += englishText;
            } else {
                prompt += 'ğŸ”»';
            }
            
            return prompt;
        }

        async function openCEFRLevelSelector() {
            // Create a modal for selecting CEFR level with checkboxes
            const levelHTML = `
                <div id="cefr-level-modal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 9999;">
                    <div style="background: white; border-radius: 16px; padding: 32px; text-align: left; box-shadow: 0 20px 25px rgba(0,0,0,0.15); max-width: 450px;">
                        <h3 style="font-size: 20px; font-weight: bold; margin-bottom: 24px; color: #1f2937; text-align: center;">é¸æ“‡ç›®æ¨™é›£åº¦ç­‰ç´š</h3>
                        
                        <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px;">
                            <button onclick="copyCEFRPrompt('A2')" style="padding: 12px 24px; border: 2px solid #60a5fa; background: #dbeafe; color: #2563eb; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.2s;">
                                A2 (Elementary)
                            </button>
                            <button onclick="copyCEFRPrompt('B1')" style="padding: 12px 24px; border: 2px solid #60a5fa; background: #dbeafe; color: #2563eb; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.2s;">
                                B1 (Intermediate)
                            </button>
                            <button onclick="copyCEFRPrompt('B2')" style="padding: 12px 24px; border: 2px solid #60a5fa; background: #dbeafe; color: #2563eb; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.2s;">
                                B2 (Upper-Intermediate)
                            </button>
                            <button onclick="copyCEFRPrompt('C1')" style="padding: 12px 24px; border: 2px solid #60a5fa; background: #dbeafe; color: #2563eb; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.2s;">
                                C1 (Advanced)
                            </button>
                        </div>
                        
                        <div style="border-top: 2px solid #e5e7eb; padding-top: 24px; margin-bottom: 24px;">
                            <p style="font-size: 14px; font-weight: bold; color: #4b5563; margin-bottom: 12px;">é¡å¤–é¸é … (å¯è¤‡é¸)ï¼š</p>
                            <label style="display: flex; align-items: center; margin-bottom: 12px; cursor: pointer;">
                                <input type="checkbox" id="cefr-narrative-checkbox" style="width: 18px; height: 18px; margin-right: 10px; cursor: pointer;">
                                <span style="color: #374151; font-size: 14px;">ä¿æŒæ•˜äº‹çµæ§‹</span>
                            </label>
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="checkbox" id="cefr-cultural-checkbox" style="width: 18px; height: 18px; margin-right: 10px; cursor: pointer;">
                                <span style="color: #374151; font-size: 14px;">ä¿ç•™æ–‡åŒ–å…¸æ•…</span>
                            </label>
                        </div>
                        
                        <div style="display: flex; gap: 12px;">
                            <button onclick="closeCEFRModal()" style="flex: 1; padding: 12px 24px; border: 2px solid #d1d5db; background: #f3f4f6; color: #6b7280; border-radius: 8px; font-weight: bold; cursor: pointer;">
                                å–æ¶ˆ
                            </button>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', levelHTML);
        }

        function closeCEFRModal() {
            const modal = document.getElementById('cefr-level-modal');
            if (modal) modal.remove();
        }

        async function copyCEFRPrompt(level) {
            // Get checkbox states before closing modal
            const narrativeCheckbox = document.getElementById('cefr-narrative-checkbox');
            const culturalCheckbox = document.getElementById('cefr-cultural-checkbox');
            
            const options = {
                keepNarrative: narrativeCheckbox ? narrativeCheckbox.checked : false,
                keepCulturalRef: culturalCheckbox ? culturalCheckbox.checked : false
            };
            
            closeCEFRModal();
            
            try {
                // Try to read from clipboard first
                let clipboardText = '';
                try {
                    clipboardText = await navigator.clipboard.readText();
                } catch (e) {
                    console.warn('ç„¡æ³•è®€å–å‰ªè²¼ç°¿ï¼Œå°‡ä½¿ç”¨æ‡‰ç”¨ä¸­çš„é€å­—ç¨¿');
                }
                
                // Build the CEFR prompt with clipboard content or app data
                let prompt = '# Role: ä½ æ˜¯ä¸€ä½è³‡æ·±çš„è‹±èªæ•™æç·¨å¯«å°ˆå®¶ï¼Œæ“…é•·æ ¹æ“š CEFR æ¨™æº–èª¿æ•´æ–‡æœ¬é›£åº¦ã€‚\n\n';
                prompt += '# Task: è«‹å°‡æˆ‘æä¾›çš„åŸå§‹é€å­—ç¨¿ï¼Œæ”¹å¯«ç‚ºç¬¦åˆ [' + level + '] ç¨‹åº¦çš„è‹±æ–‡æ–‡ç« ã€‚\n\n';
                prompt += '# Requirements by CEFR Level:\n';
                prompt += '- è‹¥ç›®æ¨™ç‚º **A2/B1**ï¼šä½¿ç”¨å¸¸ç”¨å–®å­—ï¼ˆæ ¸å¿ƒ 2000-3000 å­—ï¼‰ï¼Œå¥å­çµæ§‹ä»¥å–®å¥ç‚ºä¸»ï¼Œé¿å…è¤‡é›œçš„å­å¥ã€‚\n';
                prompt += '- è‹¥ç›®æ¨™ç‚º **B2**ï¼šå¯ä»¥ä½¿ç”¨è¼ƒå…·é«”çš„æè¿°æ€§å‹•è©ï¼Œå…è¨±å‡ºç¾è¤‡åˆå¥ï¼Œä½†æ‡‰ä¿æŒé‚è¼¯çµæ§‹æ¸…æ™°ã€‚\n';
                prompt += '- è‹¥ç›®æ¨™ç‚º **C1**ï¼šä¿æŒåŸå§‹æ–‡ç« çš„ç²¾ç¢ºæ€§èˆ‡ä¿®é£¾èªï¼Œå¼·åŒ–å­¸è¡“æˆ–æ–‡å­¸æ€§çš„è½‰æŠ˜è©ã€‚\n\n';
                prompt += '# Guidelines:\n';
                prompt += '1. **çµæ§‹å„ªåŒ–**ï¼šå°‡åŸæœ¬é›œäº‚çš„å£èªé€å­—ç¨¿æ•´ç†æˆé‚è¼¯é€šé †çš„æ®µè½ã€‚\n';
                prompt += '2. **èªæ°£ä¿ç•™**ï¼šä¿ç•™åŸä½œè€…çš„æ ¸å¿ƒè§€é»ã€æ•…äº‹èˆ‡æƒ…æ„Ÿè‰²å½©ï¼Œä¸è¦åˆªé™¤é‡è¦çš„ä¾‹å­ã€‚\n';
                prompt += '3. **è©å½™èª¿æ•´**ï¼š[é‡å°ç›®æ¨™ç¨‹åº¦ï¼Œæ›¿æ›æ‰éæ–¼è‰±æ¾€æˆ–éæ–¼ç°¡å–®çš„è©å½™]ã€‚\n';
                
                if (options.keepNarrative) {
                    prompt += '4. **ä¿æŒæ•˜äº‹çµæ§‹**ï¼šè«‹ä¿æŒæ•˜äº‹çµæ§‹ï¼Œåƒ…ç°¡åŒ–å–®å­—èˆ‡æ–‡æ³•ã€‚\n';
                }
                if (options.keepCulturalRef) {
                    prompt += '5. **ä¿ç•™æ–‡åŒ–å…¸æ•…**ï¼šè«‹ä¿ç•™æ–‡ç« ä¸­çš„æ–‡åŒ–å…¸æ•…ï¼Œä½†è«‹ç”¨ç°¡å–®çš„è‹±æ–‡å¥å­è£œå……è§£é‡‹è©²å…¸æ•…çš„æ„æ€ã€‚\n';
                }
                
                prompt += '6. **è¼¸å‡ºæ ¼å¼**ï¼š\n';
                prompt += '   - æ¨™é¡Œï¼š[ç‚ºæ”¹å¯«å¾Œçš„æ–‡ç« èµ·ä¸€å€‹æ¨™é¡Œ]\n';
                prompt += '   - æœ¬æ–‡ï¼š[æ”¹å¯«å¾Œçš„æ–‡ç« å…§å®¹]\n';
                prompt += '   - é—œéµå–®å­—è¡¨ï¼š[åˆ—å‡º 5 å€‹ç¬¦åˆè©²ç¨‹åº¦ã€ä¸”å°ç†è§£æœ¬æ–‡è‡³é—œé‡è¦çš„å–®å­—èˆ‡ä¸­è§£]\n\n';
                prompt += '# Target Level: ' + level + '\n\n';
                prompt += '# Original Transcript (åŸå§‹é€å­—ç¨¿):\n';
                
                // Use clipboard content if available, otherwise use app data
                if (clipboardText.trim().length > 0) {
                    prompt += clipboardText;
                } else if (transcriptData.length > 0) {
                    const englishText = transcriptData.map(seg => seg.en).join(' ');
                    prompt += englishText;
                } else {
                    prompt += 'ğŸ”»';
                }
                
                await navigator.clipboard.writeText(prompt);
                
                // Save CEFR level to localStorage
                localStorage.setItem('cefrLevel', level);
                cefrLevel = level;
                
                // Enable summary mode - hide segment controls
                document.body.classList.add('summary-mode');
                
                // Update transcript title
                const transcriptTitle = document.getElementById('transcript-title');
                if (transcriptTitle) {
                    transcriptTitle.textContent = `æ‘˜è¦ï¼ˆ${level}ï¼‰`;
                }
                
                alert(`âœ… CEFR ${level} é›£åº¦èª¿æ•´ Prompt å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿\næ‘˜è¦æ¨™é¡Œå·²æ›´æ–°ç‚ºï¼šæ‘˜è¦ï¼ˆ${level}ï¼‰\nåˆ†æ®µæŒ‰éˆ•å·²éš±è—`);
                console.log(`âœ… CEFR ${level} Promptå·²è¤‡è£½ï¼Œæ¨™é¡Œå·²æ›´æ–°ç‚ºï¼šæ‘˜è¦ï¼ˆ${level}ï¼‰ï¼Œé€²å…¥æ‘˜è¦æ¨¡å¼`);
            } catch (err) {
                console.error('è¤‡è£½å¤±æ•—:', err);
                alert('è¤‡è£½å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        function copyPrompt() {
            let promptText = '';
            
            if (window.currentModalMode === 'transcript') {
                promptText = generateTranscriptPrompt();
            } else if (window.currentModalMode === 'vocab') {
                promptText = generateVocabPrompt();
            } else if (window.currentModalMode === 'quiz') {
                promptText = generateQuizPrompt();
            }
            
            if (!promptText) {
                alert('ç„¡æ³•ç”Ÿæˆprompt');
                return;
            }
            
            navigator.clipboard.writeText(promptText).then(() => {
                const copyBtn = document.getElementById('copy-prompt-btn');
                const originalHTML = copyBtn.innerHTML;
                copyBtn.innerHTML = '<span class="material-symbols-outlined">done</span>';
                copyBtn.style.color = '#10b981';
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalHTML;
                    copyBtn.style.color = '';
                }, 2000);
                
                console.log('âœ… Promptå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿');
            }).catch(err => {
                console.error('è¤‡è£½å¤±æ•—:', err);
                alert('è¤‡è£½å¤±æ•—ï¼Œè«‹é‡è©¦');
            });
        }

        async function copyTranscriptPromptFromClipboard() {
            try {
                const clipboardText = await navigator.clipboard.readText();
                const sourceText = clipboardText.trim() ? clipboardText.trim() : 'ğŸ”»';
                const promptText = `${sourceText}

å°‡ä»¥ä¸Šæœªç¶“æ•´ç†çš„æ–‡ç¨¿å…§å®¹ï¼Œæ•´ç†æˆè‹±æ–‡å’Œä¸­æ–‡éš¨æ®µè½å°ç…§çš„é€å­—ç¨¿ï¼Œä¸¦ä»¥ä»¥ä¸‹æ ¼å¼åš´æ ¼ä¾ç…§ JSON Array æ ¼å¼è¼¸å‡ºçµæœï¼šï¼š
{
    en: "When I found out my grandmother, my last living grandparent, was dying, my first thought was, \"I need to draw her hands.\" I'm a visual artist, a cartoonist for The New Yorker, and comics writer, so drawing is how I understand much of the world.",
    cn: "ç•¶æˆ‘å¾—çŸ¥æˆ‘çš„ç¥–æ¯â€”â€”æˆ‘æœ€å¾Œä¸€ä½åœ¨ä¸–çš„ç¥–çˆ¶æ¯â€”â€”å³å°‡é›¢ä¸–æ™‚ï¼Œæˆ‘çš„ç¬¬ä¸€å€‹å¿µé ­æ˜¯ï¼šã€Œæˆ‘éœ€è¦ç•«ä¸‹å¥¹çš„æ‰‹ã€‚ã€æˆ‘æ˜¯ä¸€ä½è¦–è¦ºè—è¡“å®¶ï¼Œä¹Ÿæ˜¯ã€Šç´ç´„å®¢ã€‹çš„æ¼«ç•«å®¶å’Œæ¼«ç•«ä½œè€…ï¼Œæ‰€ä»¥ç¹ªç•«æ˜¯æˆ‘ç†è§£é€™å€‹ä¸–ç•Œçš„ä¸»è¦æ–¹å¼ã€‚"
},
{
    en: "For a long time, my cartoons had been impersonal. Commentary on the world around me, sure, but not really about me. The closest my personal life got to influencing my cartoons were cartoons I lifted from things my friends and family had said around me. It was only after my daughter Ellika was born that my personal life began to creep into my cartoons more.",
    cn: "å¾ˆé•·ä¸€æ®µæ™‚é–“ä»¥ä¾†ï¼Œæˆ‘çš„æ¼«ç•«éƒ½æ˜¯éå€‹äººåŒ–çš„ã€‚å®ƒå€‘æ˜¯å°å‘¨é­ä¸–ç•Œçš„è©•è«–ï¼Œæ²’éŒ¯ï¼Œä½†ä¸¦ä¸çœŸæ­£é—œæ–¼æˆ‘è‡ªå·±ã€‚æˆ‘çš„å€‹äººç”Ÿæ´»å°æ¼«ç•«æœ€æ¥è¿‘çš„å½±éŸ¿ï¼Œé ‚å¤šå°±æ˜¯å¾æœ‹å‹å’Œå®¶äººçš„è«‡è©±ä¸­å–æã€‚ç›´åˆ°æˆ‘å¥³å…’åŸƒè‰å¡ (Ellika) å‡ºç”Ÿå¾Œï¼Œæˆ‘çš„å€‹äººç”Ÿæ´»æ‰é–‹å§‹æ›´å¤šåœ°æ»²é€é€²æˆ‘çš„æ¼«ç•«ä¸­ã€‚"
}`;

                await navigator.clipboard.writeText(promptText);
                const originalHTML = transcriptPromptBtn.innerHTML;
                transcriptPromptBtn.innerHTML = '<span class="material-symbols-outlined text-base align-middle">done</span> å·²è¤‡è£½';
                transcriptPromptBtn.classList.remove('bg-blue-50', 'text-blue-700');
                transcriptPromptBtn.classList.add('bg-emerald-50', 'text-emerald-700');

                setTimeout(() => {
                    transcriptPromptBtn.innerHTML = originalHTML;
                    transcriptPromptBtn.classList.remove('bg-emerald-50', 'text-emerald-700');
                    transcriptPromptBtn.classList.add('bg-blue-50', 'text-blue-700');
                }, 2000);
            } catch (err) {
                console.error('è®€å–æˆ–è¤‡è£½å‰ªè²¼ç°¿å¤±æ•—:', err);
                alert('ç„¡æ³•è®€å–å‰ªè²¼ç°¿å…§å®¹ï¼Œè«‹å…è¨±ç€è¦½å™¨å­˜å–å‰ªè²¼ç°¿å¾Œé‡è©¦ã€‚');
            }
        }

        function parseJSON(str) {
            str = str.trim();
            // å¦‚æœä¸æ˜¯ [ æˆ– { é–‹é ­ï¼Œå‡è¨­ç‚ºé™£åˆ—ä¸¦åŠ ä¸Š []
            if (!str.startsWith('[') && !str.startsWith('{')) {
                str = '[' + str + ']';
            }
            return JSON.parse(str);
        }

        function parseVideoUrl() {
            try {
                const input = inputArea.value.trim();
                let id = input;
                
                let m = input.match(/[?&]v=([^&]+)/);
                if (m) id = m[1];
                
                m = input.match(/youtu\.be\/([^?]+)/);
                if (m) id = m[1];
                
                id = id.split('&')[0].split('?')[0];
                
                if (id.length !== 11) throw new Error("ç„¡æ•ˆçš„å½±ç‰‡ ID");
                
                // Save to localStorage
                localStorage.setItem('videoId', id);
                
                // Clear selected words when setting new video
                selectedWords = [];
                localStorage.setItem('selectedWords', JSON.stringify(selectedWords));
                
                console.log(`âœ… å½±ç‰‡è¨­å®šç‚º: ${id}`);
                console.log(`âœ… å·²æ¸…ç©ºé¸å–çš„ç”Ÿå­—ï¼Œå³å°‡é‡æ–°æ•´ç†é é¢...`);
                
                // Reload page to reset everything
                setTimeout(() => {
                    location.reload();
                }, 500);
            } catch (e) {
                console.error("éŒ¯èª¤: " + e.message);
            }
        }

        function parseTranscript() {
            try {
                const data = parseJSON(inputArea.value);
                if (!Array.isArray(data)) throw new Error("å¿…é ˆæ˜¯é™£åˆ—");
                
                // Auto-add "t" field if missing (set to 0 or incremental)
                data.forEach((item, index) => {
                    if (!item.hasOwnProperty('t')) {
                        item.t = index * 10; // Default: 10 seconds apart
                    }
                });
                
                transcriptData = data;
                localStorage.setItem('transcriptData', JSON.stringify(transcriptData));
                
                // Clear CEFR level when importing new transcript
                localStorage.removeItem('cefrLevel');
                cefrLevel = '';
                document.body.classList.remove('summary-mode');
                const transcriptTitle = document.getElementById('transcript-title');
                if (transcriptTitle) {
                    transcriptTitle.textContent = 'é€å­—ç¨¿';
                }
                
                renderTranscript();
                closeModal();
            } catch (e) {
                console.error("æ ¼å¼éŒ¯èª¤: " + e.message);
                alert("åŒ¯å…¥å¤±æ•—ï¼š" + e.message + "\n\nè«‹ç¢ºèª JSON æ ¼å¼æ­£ç¢º");
            }
        }

        function parseVocab() {
            try {
                const data = parseJSON(inputArea.value);
                if (!Array.isArray(data)) throw new Error("å¿…é ˆæ˜¯é™£åˆ—");
                vocabData = data;
                localStorage.setItem('vocabData', JSON.stringify(vocabData));
                renderTranscript();
                renderVocab();
                closeModal();
            } catch (e) {
                console.error("æ ¼å¼éŒ¯èª¤: " + e.message);
            }
        }

        function parseQuiz() {
            try {
                const inputValue = inputArea.value.trim();
                if (!inputValue) {
                    alert('è«‹è¼¸å…¥ Quiz è³‡æ–™');
                    return;
                }
                
                const data = parseJSON(inputValue);
                
                // æª¢æŸ¥æ˜¯å¦ç‚ºé›™èªæ ¼å¼ { english: [...], chinese: [...] }
                if (typeof data === 'object' && data !== null && !Array.isArray(data) && 'english' in data && 'chinese' in data) {
                    // é›™èªæ ¼å¼
                    if (!Array.isArray(data.english) || !Array.isArray(data.chinese)) {
                        alert("éŒ¯èª¤ï¼šenglish å’Œ chinese éƒ½å¿…é ˆæ˜¯é™£åˆ—");
                        return;
                    }
                    if (data.english.length === 0 && data.chinese.length === 0) {
                        alert("éŒ¯èª¤ï¼šé¡Œåº«ä¸èƒ½ç‚ºç©º");
                        return;
                    }
                    quizData = data; // ä¿å­˜æ•´å€‹é›™èªç‰©ä»¶
                    localStorage.setItem('quizData', JSON.stringify(quizData));
                    closeModal();
                    alert(`âœ… é›™èª Quiz é¡Œåº«å·²åŒ¯å…¥\n\nè‹±æ–‡ï¼š${data.english.length} é¡Œ\nä¸­æ–‡ï¼š${data.chinese.length} é¡Œ`);
                    console.log(`âœ… é›™èª Quiz é¡Œåº«å·²åŒ¯å…¥: è‹±æ–‡ ${data.english.length} é¡Œã€ä¸­æ–‡ ${data.chinese.length} é¡Œ`);
                } else if (Array.isArray(data)) {
                    // å‚³çµ±æ ¼å¼ - å–®ä¸€é™£åˆ—
                    if (data.length === 0) {
                        alert("éŒ¯èª¤ï¼šé¡Œåº«ä¸èƒ½ç‚ºç©º");
                        return;
                    }
                    quizData = data;
                    localStorage.setItem('quizData', JSON.stringify(quizData));
                    closeModal();
                    alert(`âœ… Quiz é¡Œåº«å·²åŒ¯å…¥ï¼š${quizData.length} é¡Œ`);
                    console.log(`âœ… Quiz é¡Œåº«å·²åŒ¯å…¥: ${quizData.length} é¡Œ`);
                } else {
                    alert("æ ¼å¼éŒ¯èª¤ï¼šå¿…é ˆæ˜¯é™£åˆ—æˆ–é›™èªç‰©ä»¶\n\næ­£ç¢ºæ ¼å¼ï¼š\n{ \"english\": [...], \"chinese\": [...] }\næˆ–\n[{\"q\":\"...\", \"options\":[...], \"correct\":0}]");
                }
            } catch (e) {
                alert("æ ¼å¼éŒ¯èª¤ï¼š" + e.message + "\n\nè«‹ç¢ºèª JSON æ ¼å¼æ˜¯å¦æ­£ç¢º");
                console.error("æ ¼å¼éŒ¯èª¤: ", e);
            }
        }

        function clearTranscriptData() {
            transcriptData = [];
            selectedWords = [];
            localStorage.setItem('transcriptData', JSON.stringify(transcriptData));
            localStorage.setItem('selectedWords', JSON.stringify(selectedWords));
            
            // Clear CEFR level and exit summary mode
            localStorage.removeItem('cefrLevel');
            cefrLevel = '';
            document.body.classList.remove('summary-mode');
            
            console.log('âœ… é€å­—ç¨¿ç´€éŒ„å·²æ¸…é™¤');
            setTimeout(() => location.reload(), 500);
        }

        function clearVocabData() {
            vocabData = [];
            localStorage.setItem('vocabData', JSON.stringify(vocabData));
            console.log('âœ… å–®å­—ç´€éŒ„å·²æ¸…é™¤');
            setTimeout(() => location.reload(), 500);
        }

        function clearQuizData() {
            quizData = [];
            localStorage.setItem('quizData', JSON.stringify(quizData));
            console.log('âœ… Quiz é¡Œåº«å·²æ¸…é™¤');
            setTimeout(() => location.reload(), 500);
        }

        // Render Functions
        function renderTranscript() {
            const container = document.getElementById('transcript-content');
            if (transcriptData.length === 0) return;
            
            container.innerHTML = "";
            const sortedVocab = [...vocabData].sort((a,b) => b.word.length - a.word.length);

            transcriptData.forEach((seg, idx) => {
                let text = seg.en;  // ä¿æŒç´”æ–‡æœ¬é€²è¡Œæ›¿æ›
                
                // å…ˆé€²è¡Œæ‰€æœ‰æ›¿æ›ï¼Œå»ºç«‹æ¨™è¨˜åˆ—è¡¨
                const replacements = [];
                
                // Collect all vocab replacements
                sortedVocab.forEach(v => {
                    const roots = v.roots || [v.word];
                    const pattern = roots.map(r => r.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')).join('|');
                    const regex = new RegExp(`\\b(${pattern})\\b`, 'gi');
                    let match;
                    while ((match = regex.exec(text)) !== null) {
                        replacements.push({
                            start: match.index,
                            end: match.index + match[0].length,
                            word: match[0],
                            vocab: v,
                            type: 'vocab'
                        });
                    }
                });
                
                // Collect all selected word replacements
                selectedWords.forEach(word => {
                    const escaped = word.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                    const regex = new RegExp(`\\b(${escaped})\\b`, 'gi');
                    let match;
                    while ((match = regex.exec(text)) !== null) {
                        replacements.push({
                            start: match.index,
                            end: match.index + match[0].length,
                            word: match[0],
                            selectedWord: word,
                            type: 'selected'
                        });
                    }
                });
                
                // Sort by start position (descending) to replace from end to start
                replacements.sort((a, b) => b.start - a.start);
                
                // Remove overlapping replacements (keep the first one found)
                const finalReplacements = [];
                replacements.forEach(rep => {
                    const overlaps = finalReplacements.some(r => 
                        (rep.start >= r.start && rep.start < r.end) ||
                        (rep.end > r.start && rep.end <= r.end)
                    );
                    if (!overlaps) {
                        finalReplacements.push(rep);
                    }
                });
                
                // Apply replacements from end to start
                let html = text;
                finalReplacements.forEach(rep => {
                    const before = html.substring(0, rep.start);
                    const after = html.substring(rep.end);
                    let replacement = '';
                    
                    if (rep.type === 'vocab') {
                        const isCustom = rep.vocab.custom ? 'vocab-word-custom' : 'vocab-word';
                        replacement = `<span class="${isCustom}" data-id="${rep.vocab.id || rep.vocab.word}" 
                                           onmouseenter="showCard(event, '${rep.vocab.id || rep.vocab.word}')" 
                                           onmouseleave="hideCard()" 
                                           onclick="toggleCard(event, '${rep.vocab.id || rep.vocab.word}')">${rep.word}</span>`;
                    } else if (rep.type === 'selected') {
                        replacement = `<span class="selected-word" onclick="removeSelectedWord('${rep.selectedWord}')" style="cursor: pointer; text-decoration: underline;" title="é»æ“Šå–æ¶ˆé¸å–">${rep.word}</span>`;
                    }
                    
                    html = before + replacement + after;
                });

                const hasTime = typeof seg.t === 'number';
                const timeLabel = hasTime ? formatTime(seg.t) : 'Set';
                const timeClass = hasTime ? 'bg-green-50 text-green-700' : 'bg-slate-100 text-slate-600';
                const minutes = hasTime ? Math.floor(seg.t / 60) : '';
                const seconds = hasTime ? seg.t % 60 : '';

                container.innerHTML += `
                    <div class="mb-6" id="seg-${idx}">
                        <div class="flex gap-2 mb-2 flex-wrap items-center">
                            ${cefrLevel ? `<div class="flex gap-1 items-center">
                                <button class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors" 
                                        onclick="speakSegment(${idx})" title="æ’­æ”¾æ­¤æ®µè½">
                                    ğŸ”Š Read
                                </button>
                                <button id="pause-btn-${idx}" class="px-3 py-1.5 rounded-lg border-2 border-indigo-200 bg-indigo-50 text-indigo-700 text-xs font-semibold hover:bg-indigo-100 transition-colors opacity-50" 
                                        onclick="togglePauseSegment(${idx})" title="æš«åœ/ç¹¼çºŒæ’­æ”¾" style="cursor: not-allowed;">
                                    â¸ Pause
                                </button>
                            </div>` : ''}
                            <button class="segment-time-btn px-3 py-1.5 rounded-lg border-2 ${timeClass} text-xs font-semibold transition-colors" 
                                    onclick="jumpToTime(${hasTime ? seg.t : 'null'})">
                                âµ ${timeLabel}
                            </button>
                            <div class="segment-time-inputs flex items-center gap-0 bg-blue-50 rounded-lg border-2 border-blue-200 overflow-hidden">

                                <div class="flex items-center gap-0.5 px-2 py-1.5">
                                    <input type="number" id="min-input-${idx}" min="0" max="999" step="1" 
                                           class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400"
                                           placeholder="0" value="${minutes}"
                                           onchange="setTimeByInput(${idx})"
                                           onkeypress="if(event.key==='Enter') setTimeByInput(${idx})">
                                    <span class="text-xs font-bold text-blue-700">:</span>
                                    <input type="number" id="sec-input-${idx}" min="0" max="59" step="1" 
                                           class="w-14 px-2 py-0.5 rounded border border-blue-300 bg-white text-sm font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-400"
                                           placeholder="00" value="${seconds ? String(seconds).padStart(2, '0') : ''}"
                                           onchange="setTimeByInput(${idx})"
                                           onkeypress="if(event.key==='Enter') setTimeByInput(${idx})">
                                <div class="h-6 w-px bg-blue-200 ml-3"></div>
                                
                                   </div>
                            </div>
                            <button class="segment-edit-btn px-3 py-1.5 rounded-lg border-2 border-amber-200 bg-amber-50 text-amber-700 text-xs font-semibold hover:bg-amber-100 transition-colors" 
                                    onclick="editSegment(${idx})">
                                âœï¸ Edit
                            </button>
                            </div>
                        <p class="mb-2 text-slate-800 leading-relaxed" id="en-${idx}">${html}</p>
                        ${seg.cn ? `<p class="cn-text hidden text-slate-600 pl-4 border-l-4 border-blue-200 italic text-base" id="cn-${idx}">${seg.cn}</p>` : ''}
                    </div>`;
            });
            
            applyTranslationState();
        }

        function showAddVocabModal() {
            document.getElementById('add-vocab-modal').classList.remove('hidden');
            document.getElementById('add-vocab-input').focus();
        }

        function closeAddVocabModal() {
            document.getElementById('add-vocab-modal').classList.add('hidden');
            // æ¸…ç©ºè¡¨å–®
            document.getElementById('add-vocab-input').value = '';
        }

        function addNewVocabFromJSON() {
            try {
                const input = document.getElementById('add-vocab-input').value.trim();
                if (!input) {
                    alert('è«‹è¼¸å…¥å–®å­—è³‡æ–™');
                    return;
                }
                
                const data = parseJSON(input);
                if (!Array.isArray(data)) {
                    alert('æ ¼å¼éŒ¯èª¤ï¼šå¿…é ˆæ˜¯é™£åˆ—');
                    return;
                }
                
                if (data.length === 0) {
                    alert('è«‹è‡³å°‘æ–°å¢ä¸€å€‹å–®å­—');
                    return;
                }
                
                let addedCount = 0;
                data.forEach(item => {
                    if (!item.word) return; // è·³éæ²’æœ‰ word çš„é …ç›®
                    
                    // æª¢æŸ¥æ˜¯å¦é‡è¤‡
                    if (vocabData.some(v => v.word.toLowerCase() === item.word.toLowerCase())) {
                        console.warn(`âš ï¸ å–®å­—å·²å­˜åœ¨ï¼Œå·²è·³é: ${item.word}`);
                        return;
                    }
                    
                    // æ·»åŠ æ–°å–®å­—ï¼ˆæ¨™è¨˜ç‚ºè‡ªè¨‚ï¼šcustom: trueï¼‰
                    const newVocab = {
                        id: item.word.toLowerCase(),
                        word: item.word.charAt(0).toUpperCase() + item.word.slice(1).toLowerCase(),
                        def: item.def || '',
                        cn: item.cn || '',
                        pos: item.pos || '',
                        custom: true  // æ¨™è¨˜ç‚ºè‡ªè¨‚å–®å­—
                    };
                    
                    vocabData.push(newVocab);
                    addedCount++;
                });
                
                if (addedCount === 0) {
                    alert('æ‰€æœ‰å–®å­—éƒ½å·²å­˜åœ¨æˆ–æ ¼å¼ä¸æ­£ç¢º');
                    return;
                }
                
                localStorage.setItem('vocabData', JSON.stringify(vocabData));
                renderVocab();
                renderTranscript();
                closeAddVocabModal();
                
                alert(`âœ… å·²æ–°å¢ ${addedCount} å€‹ç”Ÿå­—`);
                console.log(`âœ… å·²æ–°å¢ ${addedCount} å€‹ç”Ÿå­—`);
            } catch (e) {
                alert('æ ¼å¼éŒ¯èª¤ï¼š' + e.message + '\n\nè«‹ç¢ºèª JSON æ ¼å¼æ˜¯å¦æ­£ç¢º');
                console.error('æ ¼å¼éŒ¯èª¤: ', e);
            }
        }

        function renderVocab() {
            const list = document.getElementById('vocab-list');
            const count = document.getElementById('vocab-count');
            
            if (vocabData.length === 0) return;
            
            count.textContent = vocabData.length;
            list.innerHTML = "";
            
            const sortedVocab = [...vocabData].sort((a,b) => a.word.localeCompare(b.word));
            sortedVocab.forEach((v, index) => {
                list.innerHTML += `
                    <li class="p-4 hover:bg-blue-50 cursor-pointer border-b border-slate-200 last:border-b-0" 
                        onclick="scrollToVocab('${v.id || v.word}')">
                        <div class="flex items-start gap-3 mb-2">
                            <div class="text-sm font-bold text-slate-400 flex-shrink-0">${index + 1}.</div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2">
                                    <div class="font-bold text-base">${v.word}</div>
                                    <button onclick="event.stopPropagation(); speakWord('${v.word}')" class="text-slate-400 hover:text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                                        <span class="material-symbols-outlined text-sm">volume_up</span>
                                    </button>
                                </div>
                                ${v.ipa ? `<div class="text-xs text-blue-600 font-semibold mt-1">${v.ipa}</div>` : ''}
                                ${v.pos ? `<div class="text-xs text-slate-500 mt-0.5">${v.pos}</div>` : ''}
                            </div>
                        </div>
                        <div class="text-xs text-slate-600 mb-2 ml-6">${v.def || ''}</div>
                        ${v.cn ? `<div class="text-xs text-blue-700 font-semibold ml-6">${v.cn}</div>` : ''}
                    </li>`;
            });
        }
        
        function speakWord(word) {
            // ä½¿ç”¨ Web Speech API æ’­æ”¾ç™¼éŸ³
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.lang = 'en-US';
                utterance.rate = 1;
                utterance.pitch = 1;
                speechSynthesis.speak(utterance);
            } else {
                console.warn('æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³åˆæˆåŠŸèƒ½');
            }
        }

        function speakSegment(segmentIndex) {
            // æ’­æ”¾ç‰¹å®šæ®µè½çš„è‹±æ–‡æ–‡æœ¬
            if (segmentIndex < 0 || segmentIndex >= transcriptData.length) return;
            
            const segment = transcriptData[segmentIndex];
            if (!segment.en) return;
            
            if ('speechSynthesis' in window) {
                // å¦‚æœç•¶å‰æ­£åœ¨æ’­æ”¾åŒä¸€æ®µè½
                if (currentSpeakingSegment === segmentIndex) {
                    if (isSpeechPaused) {
                        // æ¢å¾©æ’­æ”¾
                        speechSynthesis.resume();
                        isSpeechPaused = false;
                        updatePauseButton(segmentIndex, false);
                    } else {
                        // æš«åœæ’­æ”¾
                        speechSynthesis.pause();
                        isSpeechPaused = true;
                        updatePauseButton(segmentIndex, true);
                    }
                } else {
                    // æ’­æ”¾æ–°æ®µè½
                    speechSynthesis.cancel();
                    currentSpeakingSegment = segmentIndex;
                    isSpeechPaused = false;
                    
                    const utterance = new SpeechSynthesisUtterance(segment.en);
                    utterance.lang = 'en-US';
                    utterance.rate = 1;
                    utterance.pitch = 1;
                    
                    // æ’­æ”¾çµæŸæ™‚é‡ç½®ç‹€æ…‹
                    utterance.onend = () => {
                        currentSpeakingSegment = null;
                        isSpeechPaused = false;
                        updatePauseButton(segmentIndex, false);
                    };
                    
                    speechSynthesis.speak(utterance);
                    updatePauseButton(segmentIndex, false);
                }
            } else {
                console.warn('æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³åˆæˆåŠŸèƒ½');
            }
        }
        
        function updatePauseButton(segmentIndex, isPaused) {
            // æ›´æ–°æš«åœ/ç¹¼çºŒæŒ‰éˆ•çš„ç‹€æ…‹
            const pauseBtn = document.getElementById(`pause-btn-${segmentIndex}`);
            if (pauseBtn) {
                pauseBtn.textContent = isPaused ? 'â–¶ Resume' : 'â¸ Pause';
                pauseBtn.style.opacity = currentSpeakingSegment === segmentIndex ? '1' : '0.5';
            }
        }
        
        function togglePauseSegment(segmentIndex) {
            // æš«åœ/ç¹¼çºŒæŒ‰éˆ•çš„é»æ“Šè™•ç†
            if (currentSpeakingSegment === segmentIndex) {
                speakSegment(segmentIndex);
            }
        }

        // YouTube Player
        function onYouTubeIframeAPIReady() {
            youtubeAPIReady = true;
            console.log('YouTube API Ready');
            // Only initialize player if a valid video ID is set
            if (videoId && videoId.length === 11) {
                player = new YT.Player('player', {
                    height: '100%',
                    width: '100%',
                    videoId: videoId,
                    playerVars: { rel: 0, modestbranding: 1 },
                    events: {
                        onReady: () => {
                            playerReady = true;
                            player.setPlaybackRate(currentPlaybackSpeed);
                            console.log('YouTube Player Ready');
                        },
                        onStateChange: (event) => {
                            updatePlayPauseButton();
                        }
                    }
                });
            }
        }
        
        function initializePlayer(id) {
            // Initialize player with a specific video ID
            if (!id || id.length !== 11) return;
            videoId = id;
            localStorage.setItem('videoId', id);
            
            // Wait for YouTube API to be ready
            if (!youtubeAPIReady || typeof YT === 'undefined' || typeof YT.Player === 'undefined') {
                console.log('ç­‰å¾… YouTube API è¼‰å…¥...');
                setTimeout(() => initializePlayer(id), 200);
                return;
            }
            
            if (!player) {
                player = new YT.Player('player', {
                    height: '100%',
                    width: '100%',
                    videoId: videoId,
                    playerVars: { rel: 0, modestbranding: 1 },
                    events: {
                        onReady: () => {
                            playerReady = true;
                            player.setPlaybackRate(currentPlaybackSpeed);
                            console.log('YouTube Player Ready');
                        },
                        onStateChange: (event) => {
                            updatePlayPauseButton();
                        }
                    }
                });
            } else if (playerReady) {
                player.loadVideoById(videoId);
            }
        }

        function jumpToTime(seconds) {
            if (!player || !playerReady || typeof seconds !== 'number') return;
            player.seekTo(seconds, true);
            player.playVideo();
        }

        

        

        // Insert Transcript Modal Functions
        let currentInsertIndex = null;

        function openInsertModal(idx) {
            currentInsertIndex = idx;
            document.getElementById('insert-segment-index').textContent = idx + 1;
            document.getElementById('insert-input').value = '';
            document.getElementById('insert-modal').classList.remove('hidden');
            document.getElementById('insert-input').focus();
        }

        function closeInsertModal() {
            document.getElementById('insert-modal').classList.add('hidden');
            currentInsertIndex = null;
        }

        function copyInsertPrompt() {
            let promptText = '';
            
            // Add video URL if available
            if (videoId && videoId.length === 11) {
                promptText += `https://www.youtube.com/watch?v=${videoId}\n\n`;
            } else {
                promptText += 'ğŸ”»\n\n';
            }
            
            promptText += `å°‡ä»¥ä¸Šå½±ç‰‡å¾ ${formatTime(transcriptData[currentInsertIndex]?.t || 0)} é–‹å§‹çš„æ¼”è¬›å…§å®¹ï¼Œæ•´ç†æˆè‹±æ–‡å’Œä¸­æ–‡éš¨æ®µè½å°ç…§çš„é€å­—ç¨¿ï¼Œä¸¦ä»¥ä»¥ä¸‹æ ¼å¼åš´æ ¼ä¾ç…§ JSON Array æ ¼å¼è¼¸å‡ºçµæœï¼š
{
    en: "When I found out my grandmother, my last living grandparent, was dying, my first thought was, \"I need to draw her hands.\" I'm a visual artist, a cartoonist for The New Yorker, and comics writer, so drawing is how I understand much of the world.",
    cn: "ç•¶æˆ‘å¾—çŸ¥æˆ‘çš„ç¥–æ¯â€”â€”æˆ‘æœ€å¾Œä¸€ä½åœ¨ä¸–çš„ç¥–çˆ¶æ¯â€”â€”å³å°‡é›¢ä¸–æ™‚ï¼Œæˆ‘çš„ç¬¬ä¸€å€‹å¿µé ­æ˜¯ï¼šã€Œæˆ‘éœ€è¦ç•«ä¸‹å¥¹çš„æ‰‹ã€‚ã€æˆ‘æ˜¯ä¸€ä½è¦–è¦ºè—è¡“å®¶ï¼Œä¹Ÿæ˜¯ã€Šç´ç´„å®¢ã€‹çš„æ¼«ç•«å®¶å’Œæ¼«ç•«ä½œè€…ï¼Œæ‰€ä»¥ç¹ªç•«æ˜¯æˆ‘ç†è§£é€™å€‹ä¸–ç•Œçš„ä¸»è¦æ–¹å¼ã€‚"
},
{
    en: "For a long time, my cartoons had been impersonal. Commentary on the world around me, sure, but not really about me. The closest my personal life got to influencing my cartoons were cartoons I lifted from things my friends and family had said around me. It was only after my daughter Ellika was born that my personal life began to creep into my cartoons more.",
    cn: "å¾ˆé•·ä¸€æ®µæ™‚é–“ä»¥ä¾†ï¼Œæˆ‘çš„æ¼«ç•«éƒ½æ˜¯éå€‹äººåŒ–çš„ã€‚å®ƒå€‘æ˜¯å°å‘¨é­ä¸–ç•Œçš„è©•è«–ï¼Œæ²’éŒ¯ï¼Œä½†ä¸¦ä¸çœŸæ­£é—œæ–¼æˆ‘è‡ªå·±ã€‚æˆ‘çš„å€‹äººç”Ÿæ´»å°æ¼«ç•«æœ€æ¥è¿‘çš„å½±éŸ¿ï¼Œé ‚å¤šå°±æ˜¯å¾æœ‹å‹å’Œå®¶äººçš„è«‡è©±ä¸­å–æã€‚ç›´åˆ°æˆ‘å¥³å…’åŸƒè‰å¡ (Ellika) å‡ºç”Ÿå¾Œï¼Œæˆ‘çš„å€‹äººç”Ÿæ´»æ‰é–‹å§‹æ›´å¤šåœ°æ»²é€é€²æˆ‘çš„æ¼«ç•«ä¸­ã€‚"
}`;
            
            navigator.clipboard.writeText(promptText).then(() => {
                const copyBtn = document.getElementById('copy-insert-prompt-btn');
                const originalHTML = copyBtn.innerHTML;
                copyBtn.innerHTML = '<span class="material-symbols-outlined">done</span>';
                copyBtn.classList.remove('bg-indigo-50', 'text-indigo-700');
                copyBtn.classList.add('bg-green-50', 'text-green-700');
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalHTML;
                    copyBtn.classList.remove('bg-green-50', 'text-green-700');
                    copyBtn.classList.add('bg-indigo-50', 'text-indigo-700');
                }, 2000);
                
                console.log('âœ… Insert Promptå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿');
            }).catch(err => {
                console.error('è¤‡è£½å¤±æ•—:', err);
                alert('è¤‡è£½å¤±æ•—ï¼Œè«‹é‡è©¦');
            });
        }

        function insertTranscriptFromIndex() {
            if (currentInsertIndex === null || currentInsertIndex === undefined) return;
            
            try {
                const input = document.getElementById('insert-input').value.trim();
                if (!input) {
                    alert('è«‹è¼¸å…¥é€å­—ç¨¿è³‡æ–™');
                    return;
                }
                
                const newData = parseJSON(input);
                if (!Array.isArray(newData)) {
                    alert('æ ¼å¼éŒ¯èª¤ï¼šå¿…é ˆæ˜¯é™£åˆ—');
                    return;
                }
                
                if (newData.length === 0) {
                    alert('è«‹è‡³å°‘è¼¸å…¥ä¸€æ®µé€å­—ç¨¿');
                    return;
                }
                
                // Preserve segments before currentInsertIndex, replace everything from currentInsertIndex onwards
                const preservedSegments = transcriptData.slice(0, currentInsertIndex);
                transcriptData = [...preservedSegments, ...newData];
                
                localStorage.setItem('transcriptData', JSON.stringify(transcriptData));
                renderTranscript();
                closeInsertModal();
                
                alert(`âœ… å·²å¾æ®µè½ ${currentInsertIndex + 1} æ’å…¥ ${newData.length} æ®µé€å­—ç¨¿\nä¿ç•™å‰ ${currentInsertIndex} æ®µï¼Œç¸½å…± ${transcriptData.length} æ®µ`);
                console.log(`âœ… æ’å…¥é€å­—ç¨¿: ä¿ç•™ ${currentInsertIndex} æ®µï¼Œæ–°å¢ ${newData.length} æ®µï¼Œç¸½è¨ˆ ${transcriptData.length} æ®µ`);
            } catch (e) {
                alert('æ ¼å¼éŒ¯èª¤ï¼š' + e.message + '\n\nè«‹ç¢ºèª JSON æ ¼å¼æ˜¯å¦æ­£ç¢º');
                console.error('æ ¼å¼éŒ¯èª¤: ', e);
            }
        }

        function editSegment(idx) {
            const seg = transcriptData[idx];
            if (!seg) return;
            
            // Store current editing index
            window.currentEditIndex = idx;
            
            // Fill in the modal
            document.getElementById('edit-en-input').value = seg.en || '';
            document.getElementById('edit-cn-input').value = seg.cn || '';
            document.getElementById('edit-time-input').value = typeof seg.t === 'number' ? seg.t : '';
            
            // Show modal
            document.getElementById('edit-modal').classList.remove('hidden');
            
            // Focus on English input
            setTimeout(() => {
                document.getElementById('edit-en-input').focus();
            }, 100);
        }

        function closeEditModal() {
            document.getElementById('edit-modal').classList.add('hidden');
            window.currentEditIndex = null;
        }

        function saveEdit() {
            const idx = window.currentEditIndex;
            if (idx === null || idx === undefined || !transcriptData[idx]) return;
            
            const enText = document.getElementById('edit-en-input').value.trim();
            const cnText = document.getElementById('edit-cn-input').value.trim();
            const timeInput = document.getElementById('edit-time-input').value.trim();
            
            if (enText) {
                transcriptData[idx].en = enText;
            }
            
            transcriptData[idx].cn = cnText;
            
            // Save time if provided
            if (timeInput !== '') {
                const timeSeconds = parseInt(timeInput, 10);
                if (!isNaN(timeSeconds) && timeSeconds >= 0) {
                    transcriptData[idx].t = timeSeconds;
                }
            }
            
            localStorage.setItem('transcriptData', JSON.stringify(transcriptData));
            renderTranscript();
            closeEditModal();
        }
        
        function previewEditTime() {
            const timeInput = document.getElementById('edit-time-input').value.trim();
            if (timeInput === '') {
                alert('è«‹è¼¸å…¥æ™‚é–“ï¼ˆç§’ï¼‰');
                return;
            }
            
            const timeSeconds = parseInt(timeInput, 10);
            if (isNaN(timeSeconds) || timeSeconds < 0) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„æ™‚é–“ï¼ˆ0 ç§’ä»¥ä¸Šï¼‰');
                return;
            }
            
            if (player && playerReady) {
                player.seekTo(timeSeconds, true);
                player.playVideo();
                console.log(`âµ è·³è½‰åˆ° ${formatTime(timeSeconds)}`);
            } else {
                alert('å½±ç‰‡é‚„æœªè¼‰å…¥ï¼Œè«‹å…ˆè¨­å®šå½±ç‰‡');
            }
        }

        function formatTime(sec) {
            if (typeof sec !== 'number' || sec < 0) return '00:00';
            const m = Math.floor(sec / 60);
            const s = Math.floor(sec % 60);
            return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
        }

        // Interaction
        function showCard(e, id) {
            const vocab = vocabData.find(v => (v.id === id) || (v.word === id));
            if (!vocab) return;
            
            floatingCard.dataset.currentId = id;
            floatingCard.innerHTML = `
                <div class="p-4">
                    <div class="flex items-start justify-between mb-2">
                        <h3 class="text-xl font-bold flex-1">${vocab.word}</h3>
                        <button onclick="event.stopPropagation(); speakWord('${vocab.word}')" class="ml-2 p-2 rounded-lg bg-blue-50 hover:bg-blue-100 text-blue-600 transition" title="æ’­æ”¾ç™¼éŸ³">
                            <span class="material-symbols-outlined text-lg">volume_up</span>
                        </button>
                    </div>
                    <div class="text-xs text-slate-500 mb-1">${vocab.pos || ''}</div>
                    ${vocab.ipa ? `<div class="text-xs text-blue-600 font-semibold mb-3">${vocab.ipa}</div>` : ''}
                    <p class="text-sm mb-3">${vocab.def}</p>
                    ${vocab.cn ? `<p class="text-xs text-blue-700 font-bold">${vocab.cn}</p>` : ''}
                </div>`;
            
            const rect = e.target.getBoundingClientRect();
            const cardWidth = 320;
            const cardHeight = 200; // é ä¼°é«˜åº¦
            const padding = 10;
            
            // è¨ˆç®—æœ€ä½³ä½ç½®ï¼ˆé¿å…è¶…å‡ºè¢å¹•ï¼‰
            let left = rect.left;
            let top = rect.bottom + padding;
            
            // æ°´å¹³æ–¹å‘èª¿æ•´
            if (left + cardWidth > window.innerWidth) {
                left = window.innerWidth - cardWidth - padding;
            }
            if (left < padding) {
                left = padding;
            }
            
            // å‚ç›´æ–¹å‘èª¿æ•´ï¼ˆå¦‚æœä¸‹æ–¹ç©ºé–“ä¸è¶³ï¼Œé¡¯ç¤ºåœ¨ä¸Šæ–¹ï¼‰
            if (top + cardHeight > window.innerHeight) {
                top = rect.top - cardHeight - padding;
                if (top < padding) {
                    top = padding;
                }
            }
            
            floatingCard.style.left = left + 'px';
            floatingCard.style.top = top + 'px';
            floatingCard.classList.remove('hidden');
        }
        
        function toggleCard(e, id) {
            e.stopPropagation();
            e.preventDefault();
            
            // å¦‚æœå·²ç¶“é¡¯ç¤ºåŒä¸€å€‹å­—å¡ï¼Œå‰‡é—œé–‰
            if (!floatingCard.classList.contains('hidden') && floatingCard.dataset.currentId === id) {
                hideCard();
            } else {
                showCard(e, id);
            }
        }

        function hideCard() {
            floatingCard.classList.add('hidden');
            floatingCard.dataset.currentId = '';
        }
        
        // é»æ“Šå¤–éƒ¨é—œé–‰å­—å¡
        document.addEventListener('click', function(e) {
            // å»¶é²åŸ·è¡Œï¼Œè®“ toggleCard å…ˆå®Œæˆ
            setTimeout(() => {
                if (!floatingCard.classList.contains('hidden') && 
                    !floatingCard.contains(e.target) && 
                    !e.target.closest('.vocab-word') && 
                    !e.target.closest('.vocab-word-custom')) {
                    hideCard();
                }
            }, 100);
        });

        function toggleTranslations() {
            translationsVisible = !translationsVisible;
            const toggleBtnText = document.getElementById('toggle-btn-text');
            const cnToggleText = document.getElementById('cn-toggle-text');
            
            if (toggleBtnText) {
                toggleBtnText.innerText = translationsVisible ? "Hide CN" : "Show CN";
            }
            if (cnToggleText) {
                cnToggleText.innerText = translationsVisible ? "éš±è—" : "ä¸­æ–‡";
            }
            
            applyTranslationState();
        }

        // Quiz Logic
        function openQuiz() {
            const modal = document.getElementById('quiz-modal');
            modal.classList.remove('hidden');
            
            // æª¢æŸ¥æ˜¯å¦ç‚ºé›™èªæ ¼å¼
            const isBilingual = typeof quizData === 'object' && quizData !== null && !Array.isArray(quizData) && 'english' in quizData && 'chinese' in quizData;
            
            // é¡¯ç¤ºæˆ–éš±è—èªè¨€é¸æ“‡å™¨
            const languageSelector = document.getElementById('quiz-language-selector');
            if (isBilingual) {
                languageSelector.classList.remove('hidden');
                updateQuizLanguageSelector();
            } else {
                languageSelector.classList.add('hidden');
            }
            
            renderQuizContent();
        }

        function renderQuizContent() {
            const content = document.getElementById('quiz-content');
            const footer = document.getElementById('quiz-footer');

            // æª¢æŸ¥æ˜¯å¦ç‚ºé›™èªæ ¼å¼æˆ–å‚³çµ±æ ¼å¼
            let questionsToDisplay = [];
            let isBilingual = false;
            
            if (typeof quizData === 'object' && quizData !== null && !Array.isArray(quizData) && 'english' in quizData && 'chinese' in quizData) {
                // é›™èªæ ¼å¼
                isBilingual = true;
                questionsToDisplay = quizLanguage === 'english' ? quizData.english : quizData.chinese;
            } else if (Array.isArray(quizData)) {
                // å‚³çµ±æ ¼å¼
                questionsToDisplay = quizData;
            }

            if (!Array.isArray(questionsToDisplay) || questionsToDisplay.length === 0) {
                content.innerHTML = `
                    <div class="p-6 rounded-xl border border-slate-200 bg-slate-50 text-slate-700">
                        å°šæœªåŒ¯å…¥ Quiz é¡Œåº«ï¼Œè«‹å…ˆç”¨ä¸Šæ–¹çš„ Quiz Data æŒ‰éˆ•è²¼ä¸Šé¡Œåº«ã€‚
                    </div>
                `;
                footer.innerHTML = `<button onclick="closeQuiz()" class="bg-slate-800 text-white px-6 py-2 rounded-lg font-bold hover:bg-slate-900 transition">Close</button>`;
                return;
            }

            footer.innerHTML = `<button onclick="submitQuiz()" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-blue-700 shadow-md transition">Submit Answers</button>`;

            content.innerHTML = questionsToDisplay.map((q, i) => `
                <div class="mb-6 p-5 rounded-xl border border-gray-100 hover:border-blue-100 transition-colors" id="q-block-${i}">
                    <p class="font-bold text-lg mb-4 text-slate-800 flex gap-2">
                        <span class="bg-blue-100 text-blue-700 w-7 h-7 flex items-center justify-center rounded-full text-sm shrink-0">${i + 1}</span>
                        ${q.q}
                    </p>
                    <div class="space-y-3 pl-9">
                        ${(q.options || []).map((opt, optIdx) => `
                            <label class="flex items-center p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition group">
                                <input type="radio" name="q${i}" value="${optIdx}" class="mr-3 w-4 h-4 text-blue-600 focus:ring-blue-500">
                                <span class="text-slate-600 group-hover:text-slate-900">${opt}</span>
                            </label>
                        `).join('')}
                    </div>
                    <div class="feedback hidden mt-4 ml-9 p-3 rounded-lg text-sm font-bold flex items-center gap-2"></div>
                </div>
            `).join('');
        }

        function closeQuiz() {
            document.getElementById('quiz-modal').classList.add('hidden');
        }

        function submitQuiz() {
            let score = 0;
            let allAnswered = true;

            // æ±ºå®šä½¿ç”¨å“ªä»½é¡Œåº«
            let questionsToScore = [];
            if (typeof quizData === 'object' && quizData !== null && !Array.isArray(quizData) && 'english' in quizData && 'chinese' in quizData) {
                // é›™èªæ ¼å¼ - æ ¹æ“šé¸æ“‡çš„èªè¨€å–ç”¨å°æ‡‰ç‰ˆæœ¬
                questionsToScore = quizLanguage === 'english' ? quizData.english : quizData.chinese;
            } else if (Array.isArray(quizData)) {
                // å‚³çµ±æ ¼å¼
                questionsToScore = quizData;
            }

            questionsToScore.forEach((q, i) => {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                const block = document.getElementById(`q-block-${i}`);
                const feedback = block ? block.querySelector('.feedback') : null;

                if (!block || !feedback) return;

                block.classList.remove('bg-green-50', 'border-green-200', 'bg-red-50', 'border-red-200');
                feedback.className = 'feedback hidden mt-4 ml-9 p-3 rounded-lg text-sm font-bold flex items-center gap-2';

                if (selected) {
                    feedback.classList.remove('hidden');
                    if (parseInt(selected.value, 10) === q.correct) {
                        score++;
                        feedback.innerHTML = `<span class="material-symbols-outlined">check_circle</span> Correct!`;
                        feedback.classList.add('bg-green-100', 'text-green-700');
                        block.classList.add('bg-green-50/50', 'border-green-200');
                    } else {
                        feedback.innerHTML = `<span class="material-symbols-outlined">cancel</span> Incorrect. The correct answer is: <span class="italic">${q.options[q.correct]}</span>`;
                        feedback.classList.add('bg-red-100', 'text-red-700');
                        block.classList.add('bg-red-50/50', 'border-red-200');
                    }
                } else {
                    allAnswered = false;
                }
            });

            const footer = document.getElementById('quiz-footer');
            if (allAnswered || confirm("You haven't answered all questions. Submit anyway?")) {
                let message = '';
                let colorClass = '';

                if (score === questionsToScore.length) {
                    message = 'Perfect Score! ğŸ‰';
                    colorClass = 'text-green-600';
                } else if (score > questionsToScore.length / 2) {
                    message = 'Great Job! ğŸ‘';
                    colorClass = 'text-blue-600';
                } else {
                    message = 'Keep Practicing! ğŸ’ª';
                    colorClass = 'text-orange-500';
                }

                footer.innerHTML = `
                    <div class="flex items-center gap-4 w-full justify-between">
                        <div>
                            <p class="text-sm text-gray-500 uppercase tracking-wider font-bold">Your Score</p>
                            <p class="text-2xl font-bold ${colorClass}">${score} / ${questionsToScore.length} - ${message}</p>
                        </div>
                        <button onclick="closeQuiz()" class="bg-slate-800 text-white px-6 py-2 rounded-lg font-bold hover:bg-slate-900 transition">Close</button>
                    </div>`;
            }
        }

        function applyTranslationState() {
            document.querySelectorAll('.cn-text').forEach(el => {
                if (translationsVisible) {
                    el.classList.remove('hidden');
                } else {
                    el.classList.add('hidden');
                }
            });
        }

        function scrollToVocab(id) {
            const span = document.querySelector(`.vocab-word[data-id="${id}"]`);
            if (span) {
                span.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function increaseFontSize() {
            if (currentFontSize < 32) {
                currentFontSize += 2;
                applyFontSize();
            }
        }

        function decreaseFontSize() {
            if (currentFontSize > 12) {
                currentFontSize -= 2;
                applyFontSize();
            }
        }

        function applyFontSize() {
            const transcriptContent = document.getElementById('transcript-content');
            if (transcriptContent) {
                transcriptContent.style.fontSize = currentFontSize + 'px';
            }
        }

        function increasePlaybackSpeed() {
            if (!player || !playerReady) return;
            const speeds = [0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0];
            const currentIndex = speeds.indexOf(currentPlaybackSpeed);
            if (currentIndex < speeds.length - 1) {
                currentPlaybackSpeed = speeds[currentIndex + 1];
                player.setPlaybackRate(currentPlaybackSpeed);
                updateSpeedDisplay();
            }
        }

        function decreasePlaybackSpeed() {
            if (!player || !playerReady) return;
            const speeds = [0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 1.75, 2.0];
            const currentIndex = speeds.indexOf(currentPlaybackSpeed);
            if (currentIndex > 0) {
                currentPlaybackSpeed = speeds[currentIndex - 1];
                player.setPlaybackRate(currentPlaybackSpeed);
                updateSpeedDisplay();
            }
        }

        function updateSpeedDisplay() {
            const display = document.getElementById('speed-display');
            if (display) {
                display.textContent = currentPlaybackSpeed.toFixed(2) + 'x';
            }
        }

        function togglePlayPause() {
            if (!player || !playerReady) return;
            
            const state = player.getPlayerState();
            const playIcon = document.getElementById('play-icon');
            const playText = document.getElementById('play-text');
            
            // YT.PlayerState: UNSTARTED (-1), ENDED (0), PLAYING (1), PAUSED (2), BUFFERING (3), CUED (5)
            if (state === 1) { // Playing
                player.pauseVideo();
                playIcon.textContent = 'play_arrow';
                playText.textContent = 'æ’­æ”¾';
            } else { // Paused or other states
                player.playVideo();
                playIcon.textContent = 'pause';
                playText.textContent = 'æš«åœ';
            }
        }

        function updatePlayPauseButton() {
            if (!player || !playerReady) return;
            const state = player.getPlayerState();
            const playIcon = document.getElementById('play-icon');
            const playText = document.getElementById('play-text');
            
            if (state === 1) { // Playing
                playIcon.textContent = 'pause';
                playText.textContent = 'æš«åœ';
            } else {
                playIcon.textContent = 'play_arrow';
                playText.textContent = 'æ’­æ”¾';
            }
        }

        function resetSettings() {
            currentFontSize = 18;
            applyFontSize();
            
            if (player && playerReady) {
                currentPlaybackSpeed = 1.0;
                player.setPlaybackRate(currentPlaybackSpeed);
                updateSpeedDisplay();
            }
            
            translationsVisible = false;
            const toggleBtnText = document.getElementById('toggle-btn-text');
            const cnToggleText = document.getElementById('cn-toggle-text');
            if (toggleBtnText) toggleBtnText.innerText = 'Show CN';
            if (cnToggleText) cnToggleText.innerText = 'ä¸­æ–‡';
            applyTranslationState();
        }

        function changeVideoUrl() {
            const newUrl = prompt('è²¼ä¸Š YouTube ç¶²å€æˆ–å½±ç‰‡ ID:', videoId);
            if (!newUrl || newUrl.trim() === '') return;
            
            try {
                let id = newUrl.trim();
                
                // æå–å½±ç‰‡ ID
                let m = id.match(/[?&]v=([^&]+)/);
                if (m) id = m[1];
                
                m = id.match(/youtu\.be\/([^?]+)/);
                if (m) id = m[1];
                
                id = id.split('&')[0].split('?')[0];
                
                if (id.length !== 11) throw new Error("ç„¡æ•ˆçš„å½±ç‰‡ ID");
                
                videoId = id;
                if (player && playerReady) {
                    player.loadVideoById(videoId);
                    console.log(`âœ… å½±ç‰‡å·²æ›´æ›: ${videoId}`);
                }
            } catch (e) {
                console.error("éŒ¯èª¤: " + e.message);
            }
        }

        // Export Function
        function downloadHTML() {
            const clone = document.documentElement.cloneNode(true);
            
            // Replace entire navigation bar with simplified Export-only version
            const nav = clone.querySelector('nav');
            if (nav) {
                nav.innerHTML = `
                    <div class="max-w-7xl mx-auto px-4 sm:px-6">
                        <div class="flex justify-between h-16 items-center">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center">
                                    <span class="material-symbols-outlined text-white text-xl">school</span>
                                </div>
                                <div class="flex flex-col">
                                    <div class="font-bold text-lg text-slate-900">StudyEngine</div>
                                    <div class="text-xs text-slate-500 hidden sm:block">è‹±èªå­¸ç¿’å¹³å°</div>
                                </div>
                            </div>
                            
                            <div class="relative">
                                <button onclick="toggleExportMenu()" class="px-3 py-2 rounded-lg border border-purple-200 bg-purple-50 hover:bg-purple-100 text-purple-700 transition text-sm font-medium flex items-center gap-1.5">
                                    <span class="material-symbols-outlined text-lg">bookmark</span>
                                    <span class="hidden sm:inline">Export Words (</span><span class="sm:hidden">(</span><span id="selected-count">${selectedWords.length}</span><span>)</span>
                                </button>
                                <div id="export-menu" class="hidden absolute top-full right-0 mt-2 bg-white border border-slate-200 rounded-xl shadow-lg z-50 min-w-max overflow-hidden">
                                    <button onclick="copyExportPrompt()" class="w-full px-4 py-2.5 text-left hover:bg-blue-50 border-b border-slate-100 flex items-center gap-2 text-sm" title="è¤‡è£½ç”ŸæˆAIæŒ‡ä»¤çš„Prompt">
                                        <span class="material-symbols-outlined text-sm text-blue-600">content_copy</span> <span>è¤‡è£½ Prompt</span>
                                    </button>
                                    <button onclick="exportSelectedWords()" class="w-full px-4 py-2.5 text-left hover:bg-blue-50 flex items-center gap-2 text-sm" title="ä¸‹è¼‰é¸ä¸­çš„ç”Ÿå­—">
                                        <span class="material-symbols-outlined text-sm text-blue-600">download</span> <span>ä¸‹è¼‰æ–‡å­—æª”</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Remove all Five Server and third-party injected code
            const scriptsToRemove = clone.querySelectorAll('script[data-id="five-server"], script[id="www-widgetapi-script"]');
            scriptsToRemove.forEach(s => s.remove());
            
            // Remove all injected styles (Five Server, Tailwind compiled, third-party)
            const stylesToRemove = clone.querySelectorAll('style[id*="five"], style[class*="five"], style:not([type])');
            stylesToRemove.forEach(s => {
                const content = s.textContent || '';
                if (content.includes('five-server') || 
                    content.includes('fiveserver') || 
                    content.includes('keyword-info') ||
                    content.includes('tippy-') ||
                    content.includes('ubersuggest') ||
                    content.includes('bl-info') ||
                    content.includes('kw-info') ||
                    content.includes('statistics-graph') ||
                    content.includes('ue-sidebar') ||
                    content.includes('tw-border-spacing') ||
                    content.includes('tailwindcss v3.4')) {
                    s.remove();
                }
            });
            
            // Remove Ubersuggest/extension divs
            const extensionDivs = clone.querySelectorAll('.ue-sidebar-container, [class*="ubersuggest"]');
            extensionDivs.forEach(div => div.remove());

            let html = clone.outerHTML;

            // Fix toggleExportMenu function for exported file (use 'export-menu' instead of type parameter)
            html = html.replace(
                /function toggleExportMenu\(type = 'desktop'\) \{\s*const menuId = type === 'mobile' \? 'export-menu-mobile' : 'export-menu-desktop';/,
                `function toggleExportMenu(type = 'desktop') {
            const menuId = 'export-menu';`
            );
            
            // Add toggleMobileMenu function if not present
            if (!html.includes('function toggleMobileMenu()')) {
                const insertPoint = html.indexOf('function toggleExportMenu');
                if (insertPoint !== -1) {
                    html = html.slice(0, insertPoint) + 
                           `function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const btn = document.getElementById('hamburger-btn');
            if (!menu || !btn) return;
            menu.classList.toggle('hidden');
            btn.classList.toggle('active');
        }

        ` + 
                           html.slice(insertPoint);
                }
            }

            // Remove Insert button from exported file
            html = html.replace(
                /<button[^>]*onclick="openInsertModal\([^)]*\)"[^>]*>[\s\S]*?<\/button>\s*/g,
                ''
            );

            // Inject data (keep videoId empty for exported files)
            html = html.replace(
                /let transcriptData = (?:\[.*?\]|JSON\.parse\(localStorage\.getItem\('transcriptData'\) \|\| '\[\]'\));/s,
                `let transcriptData = ${JSON.stringify(transcriptData)};`
            );
            html = html.replace(
                /let vocabData = (?:\[.*?\]|JSON\.parse\(localStorage\.getItem\('vocabData'\) \|\| '\[\]'\));/s,
                `let vocabData = ${JSON.stringify(vocabData)};`
            );
            html = html.replace(
                /let quizData = (?:\[.*?\]|\{.*?\}|JSON\.parse\(localStorage\.getItem\('quizData'\) \|\| '\[\]'\));/s,
                `let quizData = ${JSON.stringify(quizData)};`
            );
            html = html.replace(
                /let selectedWords = (?:\[.*?\]|JSON\.parse\(localStorage\.getItem\('selectedWords'\) \|\| '\[\]'\));/s,
                `let selectedWords = ${JSON.stringify(selectedWords)};`
            );
            html = html.replace(
                /let videoId = (?:localStorage\.getItem\('videoId'\) \|\| ''|'[^']*');/,
                `let videoId = localStorage.getItem('videoId') || '';`
            );

            // ç¢ºä¿ player æ˜¯ç©ºçš„ divï¼Œä¸è¦åŒ…å« iframe
            html = html.replace(
                /<iframe[^>]*id="player"[^>]*>[\s\S]*?<\/iframe>/,
                '<div id="player" class="absolute inset-0"></div>'
            );
            html = html.replace(
                /<div id="player"[^>]*>[\s\S]*?<\/div>/,
                '<div id="player" class="absolute inset-0"></div>'
            );

            // Remove Capture buttons from exported file
            html = html.replace(
                /<button[^>]*onclick="captureTime\([^)]+\)"[^>]*>[\s\S]*?Capture[\s\S]*?<\/button>/g,
                ''
            );
            
            // Remove captureTime function from exported file
            html = html.replace(
                /function captureTime\([^)]*\) \{[\s\S]*?\n        \}/,
                ''
            );
            
            // Remove setTimeByInput function from exported file
            html = html.replace(
                /function setTimeByInput\([^)]*\) \{[\s\S]*?\n        \}/,
                ''
            );
            
            // Add CSS to hide time input fields in exported file
            html = html.replace(
                /(<\/style>)/,
                `        
        /* Hide time input fields */
        .flex.items-center.gap-0.bg-blue-50 {
            display: none !important;
        }
$1`
            );
            
            // Update video section hint text
            html = html.replace(
                /é»æ“Šæ™‚é–“æ¨™ç±¤è·³è½‰ï¼ŒæŒ‰ Capture è¨­å®šç•¶å‰æ’­æ”¾æ™‚é–“/,
                'é»æ“Šæ™‚é–“æ¨™ç±¤è·³è½‰åˆ°æŒ‡å®šæ™‚é–“'
            );

            // Download
            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'study_guide.html';
            a.click();
            URL.revokeObjectURL(url);

            console.log(`âœ… åŒ¯å‡ºæˆåŠŸï¼\né€å­—ç¨¿: ${transcriptData.length} æ®µ\nå–®å­—: ${vocabData.length} å€‹\nå½±ç‰‡: éœ€é€éã€Œæ›´æ›å½±ç‰‡ã€æŒ‰éˆ•è¨­å®š`);
        }

        // Load YouTube API
        const tag = document.createElement('script');
        tag.src = 'https://www.youtube.com/iframe_api';
        document.head.appendChild(tag);

        // Global YouTube Ready handler
        window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;

        // Initialize if data exists
        if (transcriptData.length > 0 || vocabData.length > 0) {
            renderTranscript();
            renderVocab();
        }
        
        // Update transcript title if CEFR level is set
        if (cefrLevel) {
            const transcriptTitle = document.getElementById('transcript-title');
            if (transcriptTitle) {
                transcriptTitle.textContent = `æ‘˜è¦ï¼ˆ${cefrLevel}ï¼‰`;
            }
            // Activate summary mode if CEFR level is persisted
            document.body.classList.add('summary-mode');
        }
        
        // Update selected word count
        updateSelectedCount();
        
        // Text Selection Handler
        document.addEventListener('mouseup', handleTextSelection);
        
        function handleTextSelection(e) {
            const selection = window.getSelection();
            const selectedText = selection.toString().trim();
            
            if (!selectedText || selectedText.length === 0) {
                hideSelectionPopup();
                return;
            }
            
            // Check if selection is within transcript
            const container = document.getElementById('transcript-content');
            if (!container || !container.contains(selection.anchorNode)) {
                hideSelectionPopup();
                return;
            }
            
            // Show popup near cursor
            const popup = document.getElementById('selection-popup');
            const range = selection.getRangeAt(0);
            const rect = range.getBoundingClientRect();
            
            popup.style.left = (rect.left + rect.width / 2 - 60) + 'px';
            popup.style.top = (rect.top - 45) + 'px';
            popup.classList.remove('hidden');
            
            popup.onclick = () => addSelectedWord(selectedText);
        }
        
        function hideSelectionPopup() {
            const popup = document.getElementById('selection-popup');
            if (popup) popup.classList.add('hidden');
        }
        
        function addSelectedWord(word) {
            word = word.trim();
            if (!word || selectedWords.includes(word)) {
                hideSelectionPopup();
                window.getSelection().removeAllRanges();
                return;
            }
            
            selectedWords.push(word);
            localStorage.setItem('selectedWords', JSON.stringify(selectedWords));
            updateSelectedCount();
            highlightSelectedWords();
            hideSelectionPopup();
            window.getSelection().removeAllRanges();
            
            console.log(`âœ… å·²åŠ å…¥ç”Ÿå­—: ${word}`);
        }
        
        function removeSelectedWord(word) {
            word = word.trim();
            const index = selectedWords.indexOf(word);
            if (index > -1) {
                selectedWords.splice(index, 1);
                localStorage.setItem('selectedWords', JSON.stringify(selectedWords));
                updateSelectedCount();
                highlightSelectedWords();
                console.log(`âŒ å·²å–æ¶ˆé¸å–: ${word}`);
            }
        }
        
        function updateSelectedCount() {
            const countEl = document.getElementById('selected-count');
            const countElMobile = document.getElementById('selected-count-mobile');
            if (countEl) countEl.textContent = selectedWords.length;
            if (countElMobile) countElMobile.textContent = selectedWords.length;
        }
        
        function highlightSelectedWords() {
            const container = document.getElementById('transcript-content');
            if (!container) return;
            
            // Remove existing highlights
            container.querySelectorAll('.selected-word').forEach(el => {
                el.outerHTML = el.textContent;
            });
            
            // Re-render to apply new highlights
            renderTranscript();
        }
        
        function toggleExportMenu(type = 'desktop') {
            const menuId = 'export-menu';
            const menu = document.getElementById(menuId);
            if (!menu) return;
            
            menu.classList.toggle('hidden');
            
            // é»æ“Šå¤–éƒ¨æ™‚é—œé–‰é¸å–®
            if (!menu.classList.contains('hidden')) {
                document.addEventListener('click', (e) => {
                    if (!e.target.closest(`#${menuId}`) && !e.target.closest('button[onclick*="toggleExportMenu"]')) {
                        menu.classList.add('hidden');
                    }
                }, { once: true });
            }
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const btn = document.getElementById('hamburger-btn');
            
            menu.classList.toggle('hidden');
            btn.classList.toggle('active');
            
            // é»æ“Šå¤–éƒ¨æ™‚é—œé–‰é¸å–®
            if (!menu.classList.contains('hidden')) {
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#mobile-menu') && !e.target.closest('#hamburger-btn')) {
                        menu.classList.add('hidden');
                        btn.classList.remove('active');
                    }
                }, { once: true });
            }
        }

        function generateExportPrompt() {
            if (selectedWords.length === 0) {
                return '';
            }
            
            let prompt = selectedWords.join('\n');
            prompt += '\n\nå°‡ä»¥ä¸Šè‹±æ–‡å–®å­—åš´æ ¼ä¾ç…§ä»¥ä¸‹ JSON Array æ ¼å¼è¼¸å‡ºçµæœï¼š\n\n';
            prompt += '1.  **id**: å–®å­—çš„å…¨å°å¯«å½¢å¼ã€‚\n';
            prompt += '2.  **word**: å–®å­—çš„é¦–å­—æ¯å¤§å¯«ã€‚\n';
            prompt += '3.  **ipa**: è©²å–®å­—çš„ IPA éŸ³æ¨™ã€‚\n';
            prompt += '4.  **pos**: è©æ€§ (å¦‚ noun, verb, adjective)ã€‚\n';
            prompt += '5.  **def**: ç°¡æ½”çš„è‹±æ–‡å®šç¾©ã€‚\n';
            prompt += '6.  **cn**: ç¹é«”ä¸­æ–‡è§£é‡‹ (è‹¥æœ‰ç‰¹å®šèªå¢ƒè«‹ä¸€ä½µæ¨™è¨»)ã€‚\n';
            prompt += '7.  **image**: è«‹è¼¸å‡ºæ ¼å¼ç‚º `https://source.unsplash.com/featured/?{å–®å­—}` çš„é€£çµï¼Œå°‡ `{å–®å­—}` æ›¿æ›ç‚ºè©²å–®å­—çš„è‹±æ–‡å…§å®¹ï¼Œä»¥ä¾¿è‡ªå‹•æŠ“å–ç›¸é—œåœ–ç‰‡ã€‚\n\n';
            prompt += 'ç¯„ä¾‹æ ¼å¼ï¼š\n\n';
            prompt += '[\n';
            prompt += '    {\n';
            prompt += '        "id": "pareidolia",\n';
            prompt += '        "word": "Pareidolia",\n';
            prompt += '        "ipa": "/ËŒpÃ¦r.ÉªËˆdoÊŠ.li.É™/",\n';
            prompt += '        "pos": "noun",\n';
            prompt += '        "def": "The psychological phenomenon of seeing recognizable shapes, especially faces, in random or vague stimuli.",\n';
            prompt += '        "cn": "å¹»æƒ³æ€§éŒ¯è¦º (å°¤æŒ‡å°‡æ¨¡ç³Šåœ–åƒçœ‹ä½œäººè‡‰)",\n';
            prompt += '        "image": "https://source.unsplash.com/featured/?pareidolia"\n';
            prompt += '    }\n';
            prompt += ']\n';
            
            return prompt;
        }

        function copyExportPrompt() {
            if (selectedWords.length === 0) {
                alert('å°šæœªé¸å–ä»»ä½•ç”Ÿå­—');
                return;
            }
            
            const prompt = generateExportPrompt();
            navigator.clipboard.writeText(prompt).then(() => {
                document.getElementById('export-menu').classList.add('hidden');
                console.log(`âœ… Export Prompt å·²è¤‡è£½ (${selectedWords.length} å€‹ç”Ÿå­—)`);
            }).catch(() => {
                alert('è¤‡è£½å¤±æ•—ï¼Œè«‹é‡è©¦');
            });
        }

        function exportSelectedWords() {
            if (selectedWords.length === 0) {
                alert('å°šæœªé¸å–ä»»ä½•ç”Ÿå­—');
                return;
            }
            
            const text = selectedWords.map((word, i) => `${i + 1}. ${word}`).join('\n');
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'selected_words.txt';
            a.click();
            URL.revokeObjectURL(url);
            
            console.log(`âœ… å·²åŒ¯å‡º ${selectedWords.length} å€‹ç”Ÿå­—`);
        }
    </script>


</body></html>